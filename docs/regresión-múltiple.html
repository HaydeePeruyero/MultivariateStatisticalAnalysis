<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Sección 2 Regresión múltiple | Estadística Multivariada</title>
  <meta name="description" content="Curso ENES Morelia Semestre 2026-1" />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Sección 2 Regresión múltiple | Estadística Multivariada" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Curso ENES Morelia Semestre 2026-1" />
  <meta name="github-repo" content="HaydeePeruyero/MultivariateStatisticalAnalysis" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Sección 2 Regresión múltiple | Estadística Multivariada" />
  
  <meta name="twitter:description" content="Curso ENES Morelia Semestre 2026-1" />
  

<meta name="author" content="Haydeé Peruyero" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="análisis-de-componentes-principales.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MultivariateStatisticalAnalysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="01-Regresion_multiple.html"><a href="#estad%C3%ADstica-multivariada"><i class="fa fa-check"></i><b>1</b> Estadística Multivariada</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1.1</b> Temario</a></li>
<li class="chapter" data-level="1.2" data-path="01-Regresion_multiple.html"><a href="#evaluaci%C3%B3n"><i class="fa fa-check"></i><b>1.2</b> Evaluación</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#proyecto-final"><i class="fa fa-check"></i><b>1.3</b> Proyecto final</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#referencias"><i class="fa fa-check"></i><b>1.4</b> Referencias</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#material-interesante"><i class="fa fa-check"></i><b>1.5</b> Material interesante</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#datacamp"><i class="fa fa-check"></i><b>1.6</b> DataCamp</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="01-Regresion_multiple.html"><a href="#regresi%C3%B3n-m%C3%BAltiple"><i class="fa fa-check"></i><b>2</b> Regresión múltiple</a>
<ul>
<li class="chapter" data-level="2.1" data-path="01-Regresion_multiple.html"><a href="#por-qu%C3%A9-estad%C3%ADstica-multivariada"><i class="fa fa-check"></i><b>2.1</b> ¿Por qué estadística multivariada?</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="01-Regresion_multiple.html"><a href="#qu%C3%A9-es-multivariado-y-por-qu%C3%A9-lo-necesitamos"><i class="fa fa-check"></i><b>2.1.1</b> ¿Qué es “multivariado” y por qué lo necesitamos?</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="01-Regresion_multiple.html"><a href="#regresi%C3%B3n-m%C3%BAltiple-1"><i class="fa fa-check"></i><b>2.2</b> Regresión múltiple</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="01-Regresion_multiple.html"><a href="#modelo-y-estimaci%C3%B3n"><i class="fa fa-check"></i><b>2.2.1</b> Modelo y estimación</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="01-Regresion_multiple.html"><a href="#estimaci%C3%B3n-de-par%C3%A1metros"><i class="fa fa-check"></i><b>2.3</b> Estimación de parámetros</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="regresión-múltiple.html"><a href="regresión-múltiple.html"><i class="fa fa-check"></i><b>2.3.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="01-Regresion_multiple.html"><a href="#pruebas-de-hip%C3%B3tesis"><i class="fa fa-check"></i><b>2.4</b> Pruebas de Hipótesis</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="01-Regresion_multiple.html"><a href="#prueba-de-la-significancia-de-la-regresi%C3%B3n"><i class="fa fa-check"></i><b>2.4.1</b> Prueba de la significancia de la regresión</a></li>
<li class="chapter" data-level="2.4.2" data-path="01-Regresion_multiple.html"><a href="#pruebas-sobre-coeficientes-individuales-de-regresi%C3%B3n"><i class="fa fa-check"></i><b>2.4.2</b> Pruebas sobre coeficientes individuales de regresión</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="regresión-múltiple.html"><a href="regresión-múltiple.html#intervalos-de-confianza"><i class="fa fa-check"></i><b>2.5</b> Intervalos de confianza</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="01-Regresion_multiple.html"><a href="#intervalos-de-confianza-en-los-coeficientes-de-regresi%C3%B3n"><i class="fa fa-check"></i><b>2.5.1</b> Intervalos de confianza en los coeficientes de regresión</a></li>
<li class="chapter" data-level="2.5.2" data-path="regresión-múltiple.html"><a href="regresión-múltiple.html#intervalo-de-confianza-de-la-respuesta-media"><i class="fa fa-check"></i><b>2.5.2</b> Intervalo de confianza de la respuesta media</a></li>
<li class="chapter" data-level="2.5.3" data-path="regresión-múltiple.html"><a href="regresión-múltiple.html#ejercicios-1"><i class="fa fa-check"></i><b>2.5.3</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="01-Regresion_multiple.html"><a href="#ejercicios-regresi%C3%B3n-lineal-multiple"><i class="fa fa-check"></i><b>2.6</b> Ejercicios Regresión Lineal Multiple</a></li>
<li class="chapter" data-level="2.7" data-path="01-Regresion_multiple.html"><a href="#validaci%C3%B3n-de-supuestos"><i class="fa fa-check"></i><b>2.7</b> Validación de Supuestos</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="regresión-múltiple.html"><a href="regresión-múltiple.html#multicolinealidad"><i class="fa fa-check"></i><b>2.7.1</b> Multicolinealidad</a></li>
<li class="chapter" data-level="2.7.2" data-path="regresión-múltiple.html"><a href="regresión-múltiple.html#normalidad-en-los-residuales"><i class="fa fa-check"></i><b>2.7.2</b> Normalidad en los residuales</a></li>
<li class="chapter" data-level="2.7.3" data-path="regresión-múltiple.html"><a href="regresión-múltiple.html#homocedasticidad"><i class="fa fa-check"></i><b>2.7.3</b> Homocedasticidad</a></li>
<li class="chapter" data-level="2.7.4" data-path="01-Regresion_multiple.html"><a href="#no-autocorrelaci%C3%B3n"><i class="fa fa-check"></i><b>2.7.4</b> No autocorrelación</a></li>
<li class="chapter" data-level="2.7.5" data-path="regresión-múltiple.html"><a href="regresión-múltiple.html#predicciones"><i class="fa fa-check"></i><b>2.7.5</b> Predicciones</a></li>
<li class="chapter" data-level="2.7.6" data-path="regresión-múltiple.html"><a href="regresión-múltiple.html#ejercicios-2"><i class="fa fa-check"></i><b>2.7.6</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="01-Regresion_multiple.html"><a href="#an%C3%A1lisis-de-varianza"><i class="fa fa-check"></i><b>2.8</b> Análisis de Varianza</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="regresión-múltiple.html"><a href="regresión-múltiple.html#ejercicios-3"><i class="fa fa-check"></i><b>2.8.1</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="01-Regresion_multiple.html"><a href="#selecci%C3%B3n-del-modelo"><i class="fa fa-check"></i><b>2.9</b> Selección del modelo</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="regresión-múltiple.html"><a href="regresión-múltiple.html#todos-los-modelos-posibles"><i class="fa fa-check"></i><b>2.9.1</b> Todos los modelos posibles</a></li>
<li class="chapter" data-level="2.9.2" data-path="01-Regresion_multiple.html"><a href="#selecci%C3%B3n-paso-a-paso"><i class="fa fa-check"></i><b>2.9.2</b> Selección paso a paso</a></li>
<li class="chapter" data-level="2.9.3" data-path="regresión-múltiple.html"><a href="regresión-múltiple.html#ejemplos"><i class="fa fa-check"></i><b>2.9.3</b> Ejemplos</a></li>
<li class="chapter" data-level="2.9.4" data-path="01-Regresion_multiple.html"><a href="#selecci%C3%B3n-paso-a-paso-1"><i class="fa fa-check"></i><b>2.9.4</b> Selección paso a paso</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="01-Regresion_multiple.html"><a href="#an%C3%A1lisis-de-componentes-principales"><i class="fa fa-check"></i><b>3</b> Análisis de Componentes Principales</a></li>
<li class="chapter" data-level="4" data-path="01-Regresion_multiple.html"><a href="#an%C3%A1lisis-factorial"><i class="fa fa-check"></i><b>4</b> Análisis Factorial</a></li>
<li class="chapter" data-level="5" data-path="01-Regresion_multiple.html"><a href="#an%C3%A1lisis-de-conglomerados"><i class="fa fa-check"></i><b>5</b> Análisis de Conglomerados</a></li>
<li class="chapter" data-level="6" data-path="01-Regresion_multiple.html"><a href="#an%C3%A1lisis-de-discriminante"><i class="fa fa-check"></i><b>6</b> Análisis de Discriminante</a></li>
<li class="chapter" data-level="7" data-path="01-Regresion_multiple.html"><a href="#ap%C3%A9ndices"><i class="fa fa-check"></i><b>7</b> Apéndices</a>
<ul>
<li class="chapter" data-level="7.1" data-path="01-Regresion_multiple.html"><a href="#introducci%C3%B3n-a-r"><i class="fa fa-check"></i><b>7.1</b> Introducción a R</a></li>
<li class="chapter" data-level="7.2" data-path="apéndices.html"><a href="apéndices.html"><i class="fa fa-check"></i><b>7.2</b> Git + Github</a></li>
<li class="chapter" data-level="7.3" data-path="01-Regresion_multiple.html"><a href="#gr%C3%A1ficas-multivariadas"><i class="fa fa-check"></i><b>7.3</b> Gráficas Multivariadas</a></li>
<li class="chapter" data-level="7.4" data-path="01-Regresion_multiple.html"><a href="#escalas-de-medici%C3%B3n"><i class="fa fa-check"></i><b>7.4</b> Escalas de Medición</a></li>
<li class="chapter" data-level="7.5" data-path="apéndices.html"><a href="apéndices.html#valores-faltantes"><i class="fa fa-check"></i><b>7.5</b> Valores Faltantes</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/HaydeePeruyero/MultivariateStatisticalAnalysis/" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Estadística Multivariada</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regresión-múltiple" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Sección 2</span> Regresión múltiple<a href="#regresi%C3%B3n-m%C3%BAltiple" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="por-qué-estadística-multivariada" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> ¿Por qué estadística multivariada?<a href="#por-qu%C3%A9-estad%C3%ADstica-multivariada" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>El proceso de modelado consiste en construir expresiones matemáticas que permitan representar el comportamiento de una variable que queremos estudiar. Cuando contamos con varias variables, suele interesarnos analizar cómo unas influyen sobre otras, determinando si existe una relación, su intensidad y su forma. En muchos casos, estas relaciones pueden ser complejas y difíciles de describir directamente; por ello, se busca aproximarlas mediante funciones matemáticas sencillas como polinomios, que conserven los elementos esenciales para explicar el fenómeno de interés.</p>
<p>Cuando estudiamos fenómenos deterministas, es común vincular una variable dependiente con una o más variables independientes. Por ejemplo, en la ecuación de la velocidad (<span class="math inline">\(v=d/t\)</span>), la distancia depende de la velocidad y del tiempo. En la práctica, cuando realizamos distintos experimentos, las fórmulas deterministas podrían no capturar por completo el comportamiento observado. Esto puede deberse a factores no controlados, a la presencia de variabilidad natural o a efectos aleatorios. Por esta razón, además de la parte determinista del modelo, se incorpora un término que represente la discrepancia aleatoria entre lo que se predice y lo que efectivamente se observa. De forma general, esta idea se resume como:</p>
<p><span class="math display">\[Observación = Modelo \ + \ Error\]</span></p>
<p>Cuando se supone que la relación entre las variables puede representarse mediante una ecuación lineal, hablamos de <em>análisis de regresión lineal</em>. Si intervienen únicamente dos variables, una dependiente <span class="math inline">\(y\)</span> y independiente <span class="math inline">\(x\)</span>, se trata de <strong>regresión lineal simple</strong>. En cambio, cuando la variable de interés <span class="math inline">\(y\)</span> depende de dos o más variables independientes <span class="math inline">\(x_1,x_2, ...\)</span> hablamos de <strong>regresión lineal múltiple</strong>.</p>
<p><em>Supongamos que queremos predecir el rendimiento académico de un estudiante, ¿solo necesitamos las horas que estudia?</em></p>
<p>En este caso se tiene que el puntaje o rendimiento lo podemos representar con <span class="math inline">\(y\)</span> y las horas de estudio con <span class="math inline">\(x\)</span>. Entonces esta propuesta de modelo, la podríamos representar como:</p>
<p><span class="math display">\[y=\beta_0+\beta_1x\]</span>
Donde <span class="math inline">\(\beta_0\)</span> es la ordenada al origen y <span class="math inline">\(\beta_1\)</span> la pendiente. Esta recta podría no ajustarse al modelo por diferentes razones, entonces lo que se hace es considerar un error aleatorio <span class="math inline">\(\epsilon\)</span>. El modelo que ya considera este error se representa como:</p>
<p><span class="math display">\[y=\beta_0+\beta_1x+\epsilon.\]</span></p>
<p>A este modelo se le conoce como modelo de <strong>regresión lineal simple</strong> y a <span class="math inline">\(\beta_0,\beta_1\)</span> se les conoce como <strong>coeficientes de regresión</strong>.</p>
<p>En problemas reales, casi nunca una sola variable explica el fenómeno. Las decisiones y predicciones mejoran cuando integramos múltiples fuentes de información.</p>
<p>Ejemplos:
- Salud: riesgo de una enfermedad según edad, IMC, actividad física, dieta y antecedentes.
- Ingeniería: vida útil de una pieza según temperatura, vibración, material y carga.
- Biología: crecimiento de una planta por agua, luz, fertilizante, temperatura.</p>
<p><strong>Ejemplo:</strong> Si queremos predecir el rendimiento académico de un estudiante, ¿solo necesitamos las horas que estudia? ¿qué otras variables podrían influir en el puntaje de un examen?</p>
<details>
<summary>
<b> Rendimiento escolar </b>
</summary>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="regresión-múltiple.html#cb1-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-2"><a href="regresión-múltiple.html#cb1-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb1-3"><a href="regresión-múltiple.html#cb1-3" tabindex="-1"></a>data_intro <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1-4"><a href="regresión-múltiple.html#cb1-4" tabindex="-1"></a>  <span class="at">estudiante =</span> <span class="fu">paste0</span>(<span class="st">&quot;E&quot;</span>, <span class="dv">1</span><span class="sc">:</span>n),</span>
<span id="cb1-5"><a href="regresión-múltiple.html#cb1-5" tabindex="-1"></a>  <span class="at">horas_estudio =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>),</span>
<span id="cb1-6"><a href="regresión-múltiple.html#cb1-6" tabindex="-1"></a>  <span class="at">horas_sueno  =</span> <span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">7</span>,<span class="dv">6</span>,<span class="dv">9</span>,<span class="dv">7</span>),</span>
<span id="cb1-7"><a href="regresión-múltiple.html#cb1-7" tabindex="-1"></a>  <span class="at">asistencia   =</span> <span class="fu">c</span>(<span class="fl">0.9</span>,<span class="fl">0.95</span>,<span class="fl">0.8</span>,<span class="fl">0.85</span>,<span class="fl">0.7</span>,<span class="fl">0.9</span>,<span class="fl">0.8</span>,<span class="fl">0.9</span>,<span class="dv">1</span>,<span class="fl">0.95</span>),</span>
<span id="cb1-8"><a href="regresión-múltiple.html#cb1-8" tabindex="-1"></a>  <span class="at">puntaje      =</span> <span class="fu">c</span>(<span class="dv">65</span>,<span class="dv">70</span>,<span class="dv">68</span>,<span class="dv">80</span>,<span class="dv">60</span>,<span class="dv">75</span>,<span class="dv">65</span>,<span class="dv">78</span>,<span class="dv">88</span>,<span class="dv">85</span>)</span>
<span id="cb1-9"><a href="regresión-múltiple.html#cb1-9" tabindex="-1"></a>)</span>
<span id="cb1-10"><a href="regresión-múltiple.html#cb1-10" tabindex="-1"></a>data_intro</span></code></pre></div>
<pre><code>## # A tibble: 10 × 5
##    estudiante horas_estudio horas_sueno asistencia puntaje
##    &lt;chr&gt;              &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;
##  1 E1                     2           7       0.9       65
##  2 E2                     3           8       0.95      70
##  3 E3                     4           6       0.8       68
##  4 E4                     5           7       0.85      80
##  5 E5                     1           5       0.7       60
##  6 E6                     3           8       0.9       75
##  7 E7                     2           7       0.8       65
##  8 E8                     4           6       0.9       78
##  9 E9                     5           9       1         88
## 10 E10                    6           7       0.95      85</code></pre>
</details>
<p>¿Qué pasa si solo graficamos horas de estudio vs puntaje?</p>
<details>
<summary>
<b> Plot hotas de estudio vs puntaje sugerida</b>
</summary>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="regresión-múltiple.html#cb3-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-2"><a href="regresión-múltiple.html#cb3-2" tabindex="-1"></a><span class="fu">ggplot</span>(data_intro, <span class="fu">aes</span>(horas_estudio, puntaje)) <span class="sc">+</span></span>
<span id="cb3-3"><a href="regresión-múltiple.html#cb3-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb3-4"><a href="regresión-múltiple.html#cb3-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb3-5"><a href="regresión-múltiple.html#cb3-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">&quot;¿Solo horas de estudio explican el puntaje?&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="MultivariateStatisticalAnalysis_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</details>
<p>¿Se ajusta un modelo lineal? ¿Porqué?</p>
<div id="qué-es-multivariado-y-por-qué-lo-necesitamos" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> ¿Qué es “multivariado” y por qué lo necesitamos?<a href="#qu%C3%A9-es-multivariado-y-por-qu%C3%A9-lo-necesitamos" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Idea central:</strong> cuando <strong>varias</strong> <span class="math inline">\(x\)</span> influyen sobre <span class="math inline">\(y\)</span>, estudiar cada <span class="math inline">\(x\)</span> por separado puede engañarnos. El análisis multivariado permite:</p>
<ul>
<li><strong>Aislar efectos</strong>: estimar el efecto de <span class="math inline">\(x_1\)</span> <em>manteniendo constantes</em> <span class="math inline">\(x_2,x_3,...\)</span>.</li>
<li><strong>Mejorar predicción</strong>: reducir error al añadir información relevante.</li>
<li><strong>Controlar confusores</strong>: variables que cambian la relación aparente entre <span class="math inline">\(y\)</span> y <span class="math inline">\(x\)</span>.</li>
</ul>
<p><strong>Ejemplo:</strong> Si ajustamos ahora un modelo con varias variables, ¿vamos a observar un cambio? ¿se ajustará mejor?</p>
<details>
<summary>
<b>Código (modelos + comparaciones)</b>
</summary>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="regresión-múltiple.html#cb5-1" tabindex="-1"></a><span class="co"># Modelo simple</span></span>
<span id="cb5-2"><a href="regresión-múltiple.html#cb5-2" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(puntaje <span class="sc">~</span> horas_estudio, <span class="at">data =</span> data_intro)</span>
<span id="cb5-3"><a href="regresión-múltiple.html#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="regresión-múltiple.html#cb5-4" tabindex="-1"></a><span class="co"># Modelo múltiple</span></span>
<span id="cb5-5"><a href="regresión-múltiple.html#cb5-5" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(puntaje <span class="sc">~</span> horas_estudio <span class="sc">+</span> horas_sueno <span class="sc">+</span> asistencia, <span class="at">data =</span> data_intro)</span>
<span id="cb5-6"><a href="regresión-múltiple.html#cb5-6" tabindex="-1"></a></span>
<span id="cb5-7"><a href="regresión-múltiple.html#cb5-7" tabindex="-1"></a><span class="co"># Medidas clave</span></span>
<span id="cb5-8"><a href="regresión-múltiple.html#cb5-8" tabindex="-1"></a>R2_m1  <span class="ot">&lt;-</span> <span class="fu">glance</span>(m1)<span class="sc">$</span>r.squared</span>
<span id="cb5-9"><a href="regresión-múltiple.html#cb5-9" tabindex="-1"></a>R2_m2  <span class="ot">&lt;-</span> <span class="fu">glance</span>(m2)<span class="sc">$</span>r.squared</span>
<span id="cb5-10"><a href="regresión-múltiple.html#cb5-10" tabindex="-1"></a></span>
<span id="cb5-11"><a href="regresión-múltiple.html#cb5-11" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;El R2 del modelo simple:&quot;</span>, R2_m1))</span></code></pre></div>
<pre><code>## [1] &quot;El R2 del modelo simple: 0.824317362184441&quot;</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="regresión-múltiple.html#cb7-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;El R2 del modelo multiple:&quot;</span>, R2_m2))</span></code></pre></div>
<pre><code>## [1] &quot;El R2 del modelo multiple: 0.895428180549875&quot;</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="regresión-múltiple.html#cb9-1" tabindex="-1"></a><span class="co">#R2adj_m1 &lt;- glance(m1)$adj.r.squared</span></span>
<span id="cb9-2"><a href="regresión-múltiple.html#cb9-2" tabindex="-1"></a><span class="co">#R2adj _m2 &lt;- glance(m2)$adj.r.squared</span></span></code></pre></div>
<ul>
<li>¿Aumentó <span class="math inline">\(R^2\)</span> al incluir más variables? ¿Por qué tiende a subir?</li>
<li>¿Qué cambia en la interpretación de horas_estudio al controlar por horas_sueno y asistencia?</li>
<li>¿Puede un predictor ser importante en bivariado y no en multivariado (o viceversa)?</li>
</ul>
</div>
</div>
<div id="regresión-múltiple-1" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Regresión múltiple<a href="#regresi%C3%B3n-m%C3%BAltiple-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="modelo-y-estimación" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Modelo y estimación<a href="#modelo-y-estimaci%C3%B3n" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Los modelos en regresión lineal múltiple están dados por la siguiente forma, donde <span class="math inline">\(y\)</span> depende de <span class="math inline">\(p\)</span> variables predictoras:</p>
<p><span class="math display">\[y_i=\beta_0+\beta_1x_{i1}+\beta_2x_{i2} + \beta_px_{ip}+\epsilon_i.\]</span></p>
<p>Se suele asumir que los errores <span class="math inline">\(\epsilon_i\)</span> son i.i.d. con distribución normal de media 0 y varianza <span class="math inline">\(\sigma^2\)</span> desconocida. Los coeficientes <span class="math inline">\(\beta_i\)</span> son constantes desconocidas y son los parámetros del modelo. Cada <span class="math inline">\(\beta_j\)</span> representa el cambio esperado en la respuesta <span class="math inline">\(y\)</span> por el cambio unitario en <span class="math inline">\(x_i\)</span> cuando todas las demás variables independientes <span class="math inline">\(x_i(i\neq j)\)</span> se mantienen constantes.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="regresión-múltiple.html#cb10-1" tabindex="-1"></a><span class="co"># Forma general</span></span>
<span id="cb10-2"><a href="regresión-múltiple.html#cb10-2" tabindex="-1"></a>ajuste <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> ... <span class="sc">+</span> xp, <span class="at">data =</span> datos)</span>
<span id="cb10-3"><a href="regresión-múltiple.html#cb10-3" tabindex="-1"></a><span class="co"># summary(ajuste)</span></span></code></pre></div>
<p>Los coeficientes los podemos interpretar como sigue:</p>
<ul>
<li><strong>Intercepto (<span class="math inline">\(\beta_0\)</span>)</strong>: valor esperado de <span class="math inline">\(y\)</span> cuando todas las <span class="math inline">\(x\)</span>=0.</li>
<li><strong>Pendiente <span class="math inline">\(\beta_j\)</span></strong>: efecto <strong>parcial</strong> de <span class="math inline">\(x_j\)</span> sobre <span class="math inline">\(y\)</span> manteniendo las demás constantes.</li>
</ul>
<p>En los modelos de regreción lineal, solemos usar las siguientes medidas de bondad de ajuste:</p>
<ul>
<li><strong><span class="math inline">\(R^2\)</span></strong>: proporción de varianza de <span class="math inline">\(y\)</span> explicada.</li>
<li><strong><span class="math inline">\(R^2\)</span> ajustado</strong>: penaliza por número de predictores (mejor para comparar modelos con distinto número de x).</li>
<li><strong>RMSE (<span class="math inline">\(\sigma\)</span>)</strong>: error típico de predicción en unidades de <span class="math inline">\(y\)</span>.</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="regresión-múltiple.html#cb11-1" tabindex="-1"></a>comp <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(</span>
<span id="cb11-2"><a href="regresión-múltiple.html#cb11-2" tabindex="-1"></a>  <span class="fu">glance</span>(m1) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">modelo=</span><span class="st">&quot;simple&quot;</span>),</span>
<span id="cb11-3"><a href="regresión-múltiple.html#cb11-3" tabindex="-1"></a>  <span class="fu">glance</span>(m2) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">modelo=</span><span class="st">&quot;multiple&quot;</span>)</span>
<span id="cb11-4"><a href="regresión-múltiple.html#cb11-4" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(modelo, r.squared, adj.r.squared)</span>
<span id="cb11-5"><a href="regresión-múltiple.html#cb11-5" tabindex="-1"></a>comp</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   modelo   r.squared adj.r.squared
##   &lt;chr&gt;        &lt;dbl&gt;         &lt;dbl&gt;
## 1 simple       0.824         0.802
## 2 multiple     0.895         0.843</code></pre>
<p>Para este modelo algunos de los supuestos se siguen del modelo de regresión lineal
simple y se agregan algunos que tienen que ver con la relación que pudiera existir entre
las variables regresoras.</p>
<ul>
<li>El modelo es lineal en los parámetros.<br />
<em>Chequeo</em>: residuales vs ajustados sin patrón claro.</li>
<li>El modelo está especificado correctamente.</li>
<li>Covarianza cero entre variables regresoras y el error.</li>
<li>Esperanza del error igual a cero.</li>
<li>Homocedasticidad.</li>
<li>No autocorrelación entre los errores.</li>
<li>Los errores siguen una distribución normal.</li>
<li>Mas observaciones que parámetros a estimar.</li>
<li>Variación entre los valores de las variables regresoras.</li>
<li>No colinealidad (multicolinealidad) entre las variables regresoras, es decir, no existe
una relación lineal entre <span class="math inline">\(x_i\)</span> y <span class="math inline">\(x_j\)</span> (es decir, las variables son linealmente independientes).</li>
</ul>
<details>
<summary>
<b>Supuestos</b>
</summary>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="regresión-múltiple.html#cb13-1" tabindex="-1"></a><span class="co"># Modelo m2</span></span>
<span id="cb13-2"><a href="regresión-múltiple.html#cb13-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb13-3"><a href="regresión-múltiple.html#cb13-3" tabindex="-1"></a><span class="fu">plot</span>(m2, <span class="at">which=</span><span class="dv">1</span>)  <span class="co"># Residuales vs ajustados</span></span>
<span id="cb13-4"><a href="regresión-múltiple.html#cb13-4" tabindex="-1"></a><span class="fu">plot</span>(m2, <span class="at">which=</span><span class="dv">2</span>)  <span class="co"># QQ-plot</span></span></code></pre></div>
<p><img src="MultivariateStatisticalAnalysis_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</details>
<hr />
<p><strong>Ejercicio</strong>: Supongamos que tenemos los siguientes datos: precio de vivienda según metros, habitaciones y distancia al centro.</p>
<details>
<summary>
<b>Dataset</b>
</summary>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="regresión-múltiple.html#cb14-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb14-2"><a href="regresión-múltiple.html#cb14-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">14</span></span>
<span id="cb14-3"><a href="regresión-múltiple.html#cb14-3" tabindex="-1"></a>casas <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb14-4"><a href="regresión-múltiple.html#cb14-4" tabindex="-1"></a>  <span class="at">precio =</span> <span class="fu">c</span>(<span class="dv">200</span>,<span class="dv">220</span>,<span class="dv">250</span>,<span class="dv">275</span>,<span class="dv">300</span>,<span class="dv">180</span>,<span class="dv">210</span>,<span class="dv">260</span>,<span class="dv">280</span>,<span class="dv">320</span>,<span class="dv">190</span>,<span class="dv">240</span>,<span class="dv">230</span>,<span class="dv">305</span>),</span>
<span id="cb14-5"><a href="regresión-múltiple.html#cb14-5" tabindex="-1"></a>  <span class="at">metros =</span> <span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>,<span class="dv">110</span>,<span class="dv">120</span>,<span class="dv">70</span>,<span class="dv">85</span>,<span class="dv">105</span>,<span class="dv">115</span>,<span class="dv">130</span>,<span class="dv">75</span>,<span class="dv">95</span>,<span class="dv">92</span>,<span class="dv">125</span>),</span>
<span id="cb14-6"><a href="regresión-múltiple.html#cb14-6" tabindex="-1"></a>  <span class="at">habitaciones =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">4</span>),</span>
<span id="cb14-7"><a href="regresión-múltiple.html#cb14-7" tabindex="-1"></a>  <span class="at">distancia_centro =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">8</span>,<span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">7</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>)</span>
<span id="cb14-8"><a href="regresión-múltiple.html#cb14-8" tabindex="-1"></a>)</span>
<span id="cb14-9"><a href="regresión-múltiple.html#cb14-9" tabindex="-1"></a>casas</span></code></pre></div>
<pre><code>## # A tibble: 14 × 4
##    precio metros habitaciones distancia_centro
##     &lt;dbl&gt;  &lt;dbl&gt;        &lt;dbl&gt;            &lt;dbl&gt;
##  1    200     80            2                5
##  2    220     90            3                4
##  3    250    100            3                6
##  4    275    110            4                3
##  5    300    120            4                2
##  6    180     70            2                8
##  7    210     85            3                6
##  8    260    105            3                3
##  9    280    115            4                2
## 10    320    130            5                1
## 11    190     75            2                7
## 12    240     95            3                5
## 13    230     92            3                4
## 14    305    125            4                2</code></pre>
</details>
<ol style="list-style-type: decimal">
<li>Ajusta <code>precio ~ metros</code> (simple) y <code>precio ~ metros + habitaciones + distancia_centro</code> (múltiple).<br />
</li>
<li>Compara <span class="math inline">\(R^2\)</span>, <span class="math inline">\(R^2\)</span> <strong>ajustado</strong> y <strong>σ (RMSE)</strong>.<br />
</li>
<li>Interpreta el coeficiente de <code>distancia_centro</code>.<br />
</li>
<li>Revisa QQ-plot y residuales vs ajustados. ¿Algún patrón?</li>
</ol>
<details>
<summary>
<b>Solución</b>
</summary>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="regresión-múltiple.html#cb16-1" tabindex="-1"></a>m_s <span class="ot">&lt;-</span> <span class="fu">lm</span>(precio <span class="sc">~</span> metros, <span class="at">data=</span>casas)</span>
<span id="cb16-2"><a href="regresión-múltiple.html#cb16-2" tabindex="-1"></a>m_m <span class="ot">&lt;-</span> <span class="fu">lm</span>(precio <span class="sc">~</span> metros <span class="sc">+</span> habitaciones <span class="sc">+</span> distancia_centro, <span class="at">data=</span>casas)</span>
<span id="cb16-3"><a href="regresión-múltiple.html#cb16-3" tabindex="-1"></a></span>
<span id="cb16-4"><a href="regresión-múltiple.html#cb16-4" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">glance</span>(m_s)[,<span class="fu">c</span>(<span class="st">&quot;r.squared&quot;</span>,<span class="st">&quot;adj.r.squared&quot;</span>)]</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   r.squared adj.r.squared
##       &lt;dbl&gt;         &lt;dbl&gt;
## 1     0.996         0.996</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="regresión-múltiple.html#cb18-1" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">glance</span>(m_m)[,<span class="fu">c</span>(<span class="st">&quot;r.squared&quot;</span>,<span class="st">&quot;adj.r.squared&quot;</span>)]</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   r.squared adj.r.squared
##       &lt;dbl&gt;         &lt;dbl&gt;
## 1     0.997         0.996</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="regresión-múltiple.html#cb20-1" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(m_m)</span></code></pre></div>
<pre><code>## # A tibble: 4 × 5
##   term             estimate std.error statistic      p.value
##   &lt;chr&gt;               &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt;
## 1 (Intercept)        -8.67     14.9      -0.583 0.573       
## 2 metros              2.53      0.162    15.6   0.0000000236
## 3 habitaciones       -0.505     2.80     -0.180 0.861       
## 4 distancia_centro    1.38      0.974     1.42  0.187</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="regresión-múltiple.html#cb22-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb22-2"><a href="regresión-múltiple.html#cb22-2" tabindex="-1"></a><span class="fu">plot</span>(m_m, <span class="at">which=</span><span class="dv">1</span>)</span>
<span id="cb22-3"><a href="regresión-múltiple.html#cb22-3" tabindex="-1"></a><span class="fu">plot</span>(m_m, <span class="at">which=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="MultivariateStatisticalAnalysis_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</details>
</div>
</div>
<div id="estimación-de-parámetros" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Estimación de parámetros<a href="#estimaci%C3%B3n-de-par%C3%A1metros" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Ejemplo (Montgomery, 2002):</strong> : Un embotellador de bebidas gaseosas analiza las rutas de servicio de las máquinas expendedoras en su sistema de distribución. Le interesa predecir el tiempo necesario para que el representante de ruta atienda las máquinas expendedoras en una tienda.</p>
<p>Esta actividad de servicio consiste en abastecer la máquina con productos embotellados, y algo de mantenimiento o limpieza. El ingeniero industrial responsable del estudio ha sugerido que las dos variables más importantes que afectan el tiempo de entrega <span class="math inline">\(y\)</span> son la cantidad de cajas de producto abastecido, <span class="math inline">\(x_1\)</span>, y la distancia caminada por el representante, <span class="math inline">\(x_2\)</span>.</p>
<p>El ingeniero ha reunido 25 observaciones de tiempo de entrega que se ven en la tabla siguiente. Se ajustará el modelo de regresión lineal multiple siguiente:</p>
<p><span class="math display">\[
y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 +  \varepsilon
\]</span></p>
<p><em>Archivo: <code>refrescos.csv</code></em>.</p>
<details>
<summary>
<b>Base de datos</b>
</summary>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="regresión-múltiple.html#cb23-1" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb23-2"><a href="regresión-múltiple.html#cb23-2" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb23-3"><a href="regresión-múltiple.html#cb23-3" tabindex="-1"></a>  <span class="at">Observacion =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>,</span>
<span id="cb23-4"><a href="regresión-múltiple.html#cb23-4" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="fl">16.68</span>, <span class="fl">11.50</span>, <span class="fl">12.03</span>, <span class="fl">14.88</span>, <span class="fl">13.75</span>,</span>
<span id="cb23-5"><a href="regresión-múltiple.html#cb23-5" tabindex="-1"></a>        <span class="fl">18.11</span>, <span class="fl">8.00</span>, <span class="fl">17.83</span>, <span class="fl">79.24</span>, <span class="fl">21.50</span>,</span>
<span id="cb23-6"><a href="regresión-múltiple.html#cb23-6" tabindex="-1"></a>        <span class="fl">40.33</span>, <span class="fl">21.00</span>, <span class="fl">13.50</span>, <span class="fl">19.75</span>, <span class="fl">24.00</span>,</span>
<span id="cb23-7"><a href="regresión-múltiple.html#cb23-7" tabindex="-1"></a>        <span class="fl">29.00</span>, <span class="fl">15.35</span>, <span class="fl">19.00</span>, <span class="fl">9.50</span>, <span class="fl">35.10</span>,</span>
<span id="cb23-8"><a href="regresión-múltiple.html#cb23-8" tabindex="-1"></a>        <span class="fl">17.90</span>, <span class="fl">52.32</span>, <span class="fl">18.75</span>, <span class="fl">19.83</span>, <span class="fl">10.75</span>),</span>
<span id="cb23-9"><a href="regresión-múltiple.html#cb23-9" tabindex="-1"></a>  <span class="at">x1 =</span> <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">6</span>,</span>
<span id="cb23-10"><a href="regresión-múltiple.html#cb23-10" tabindex="-1"></a>         <span class="dv">7</span>, <span class="dv">2</span>, <span class="dv">7</span>, <span class="dv">30</span>, <span class="dv">5</span>,</span>
<span id="cb23-11"><a href="regresión-múltiple.html#cb23-11" tabindex="-1"></a>         <span class="dv">16</span>, <span class="dv">10</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">9</span>,</span>
<span id="cb23-12"><a href="regresión-múltiple.html#cb23-12" tabindex="-1"></a>         <span class="dv">10</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">3</span>, <span class="dv">17</span>,</span>
<span id="cb23-13"><a href="regresión-múltiple.html#cb23-13" tabindex="-1"></a>         <span class="dv">10</span>, <span class="dv">26</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">4</span>),</span>
<span id="cb23-14"><a href="regresión-múltiple.html#cb23-14" tabindex="-1"></a>  <span class="at">x2 =</span> <span class="fu">c</span>(<span class="dv">560</span>, <span class="dv">220</span>, <span class="dv">340</span>, <span class="dv">80</span>, <span class="dv">150</span>,</span>
<span id="cb23-15"><a href="regresión-múltiple.html#cb23-15" tabindex="-1"></a>         <span class="dv">330</span>, <span class="dv">110</span>, <span class="dv">210</span>, <span class="dv">1460</span>, <span class="dv">605</span>,</span>
<span id="cb23-16"><a href="regresión-múltiple.html#cb23-16" tabindex="-1"></a>         <span class="dv">688</span>, <span class="dv">215</span>, <span class="dv">255</span>, <span class="dv">462</span>, <span class="dv">448</span>,</span>
<span id="cb23-17"><a href="regresión-múltiple.html#cb23-17" tabindex="-1"></a>         <span class="dv">776</span>, <span class="dv">200</span>, <span class="dv">132</span>, <span class="dv">36</span>, <span class="dv">770</span>,</span>
<span id="cb23-18"><a href="regresión-múltiple.html#cb23-18" tabindex="-1"></a>         <span class="dv">140</span>, <span class="dv">810</span>, <span class="dv">450</span>, <span class="dv">635</span>, <span class="dv">150</span>)</span>
<span id="cb23-19"><a href="regresión-múltiple.html#cb23-19" tabindex="-1"></a>)</span>
<span id="cb23-20"><a href="regresión-múltiple.html#cb23-20" tabindex="-1"></a></span>
<span id="cb23-21"><a href="regresión-múltiple.html#cb23-21" tabindex="-1"></a>datos</span></code></pre></div>
<pre><code>##    Observacion     y x1   x2
## 1            1 16.68  7  560
## 2            2 11.50  3  220
## 3            3 12.03  3  340
## 4            4 14.88  4   80
## 5            5 13.75  6  150
## 6            6 18.11  7  330
## 7            7  8.00  2  110
## 8            8 17.83  7  210
## 9            9 79.24 30 1460
## 10          10 21.50  5  605
## 11          11 40.33 16  688
## 12          12 21.00 10  215
## 13          13 13.50  4  255
## 14          14 19.75  6  462
## 15          15 24.00  9  448
## 16          16 29.00 10  776
## 17          17 15.35  6  200
## 18          18 19.00  7  132
## 19          19  9.50  3   36
## 20          20 35.10 17  770
## 21          21 17.90 10  140
## 22          22 52.32 26  810
## 23          23 18.75  9  450
## 24          24 19.83  8  635
## 25          25 10.75  4  150</code></pre>
</details>
<p>Veamos un gráfico de dispersión de los datos. ¿Qué observamos?</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="regresión-múltiple.html#cb25-1" tabindex="-1"></a><span class="fu">pairs</span>(datos[<span class="sc">-</span><span class="dv">1</span>])</span></code></pre></div>
<p><img src="MultivariateStatisticalAnalysis_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<ol style="list-style-type: decimal">
<li>Estimar <span class="math inline">\(\beta\)</span></li>
</ol>
<p>Primero, vamos a crear la matriz <span class="math inline">\(X\)</span> y el vector <span class="math inline">\(y\)</span>.</p>
<details>
<summary>
<b>Matrices</b>
</summary>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="regresión-múltiple.html#cb26-1" tabindex="-1"></a><span class="co"># Columna de 1 para el intercepto</span></span>
<span id="cb26-2"><a href="regresión-múltiple.html#cb26-2" tabindex="-1"></a>idv <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(datos))</span>
<span id="cb26-3"><a href="regresión-múltiple.html#cb26-3" tabindex="-1"></a><span class="co"># Creamos matriz X</span></span>
<span id="cb26-4"><a href="regresión-múltiple.html#cb26-4" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(idv,datos<span class="sc">$</span>x1,datos<span class="sc">$</span>x2),<span class="at">nrow=</span><span class="dv">25</span>,<span class="at">ncol=</span><span class="dv">3</span>)</span>
<span id="cb26-5"><a href="regresión-múltiple.html#cb26-5" tabindex="-1"></a><span class="co"># Creamos el vector y</span></span>
<span id="cb26-6"><a href="regresión-múltiple.html#cb26-6" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(datos<span class="sc">$</span>y, <span class="at">nrow =</span> <span class="dv">25</span>, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code></pre></div>
</details>
<p>Ya sabemos que nuestro estimador está dado por</p>
<p><span class="math display">\[
\hat{\beta} = (X&#39;X)^{-1}X&#39;y
\]</span></p>
<p>Entonces podemos encontrar el estimador.</p>
<details>
<summary>
<b>Estimador beta</b>
</summary>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="regresión-múltiple.html#cb27-1" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(X) <span class="sc">%*%</span> X) <span class="sc">%*%</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> y</span>
<span id="cb27-2"><a href="regresión-múltiple.html#cb27-2" tabindex="-1"></a>beta</span></code></pre></div>
<pre><code>##            [,1]
## [1,] 2.34123115
## [2,] 1.61590721
## [3,] 0.01438483</code></pre>
</details>
<p>Entonces el ajuste por el método de mínimos cuadrados, con los coeficientes de regresión que encontramos está dado por:</p>
<p><span class="math inline">\(\hat{y} =\)</span> 2.3412311 <span class="math inline">\(+\)</span> 1.6159072 <span class="math inline">\(x_1\)</span> <span class="math inline">\(+\)</span> 1.6159072 <span class="math inline">\(x_2\)</span></p>
<p>Esto lo podemos hacer más rápido usando la función de <code>lm</code>. Construimos el modelo.</p>
<details>
<summary>
<b>Modelo en R</b>
</summary>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="regresión-múltiple.html#cb29-1" tabindex="-1"></a>M1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, datos)</span>
<span id="cb29-2"><a href="regresión-múltiple.html#cb29-2" tabindex="-1"></a>M1 </span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x1 + x2, data = datos)
## 
## Coefficients:
## (Intercept)           x1           x2  
##     2.34123      1.61591      0.01438</code></pre>
</details>
<p>¿Cómo accedemos a los valores del modelo?</p>
<details>
<summary>
<b>Coeficientes</b>
</summary>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="regresión-múltiple.html#cb31-1" tabindex="-1"></a>beta_0 <span class="ot">&lt;-</span> M1<span class="sc">$</span>coefficients[<span class="dv">1</span>]</span>
<span id="cb31-2"><a href="regresión-múltiple.html#cb31-2" tabindex="-1"></a>beta_1 <span class="ot">&lt;-</span> M1<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span>
<span id="cb31-3"><a href="regresión-múltiple.html#cb31-3" tabindex="-1"></a>beta_2 <span class="ot">&lt;-</span> M1<span class="sc">$</span>coefficients[<span class="dv">3</span>]</span></code></pre></div>
</details>
<p>Los valores son <span class="math inline">\(\beta_0=\)</span> 2.3412311, <span class="math inline">\(\beta_1=\)</span> 1.6159072 y <span class="math inline">\(\beta_2=\)</span> 0.0143848.</p>
<ol start="2" style="list-style-type: decimal">
<li>Estimación de la varianza del error <span class="math inline">\(\sigma^2\)</span></li>
</ol>
<p>Ya tenemos que la suma de los cuadrados de los errores está dada por</p>
<p><span class="math display">\[ SSE = y&#39;y - \hat{\beta}X&#39;y\]</span></p>
<p>Sustituimos los valores que tenemos y obtemos el SSE.</p>
<details>
<summary>
<b>SSE</b>
</summary>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="regresión-múltiple.html#cb32-1" tabindex="-1"></a>SSE <span class="ot">&lt;-</span> <span class="fu">t</span>(y)<span class="sc">%*%</span> y <span class="sc">-</span> <span class="fu">t</span>(beta) <span class="sc">%*%</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> y</span>
<span id="cb32-2"><a href="regresión-múltiple.html#cb32-2" tabindex="-1"></a>SSE</span></code></pre></div>
<pre><code>##          [,1]
## [1,] 233.7317</code></pre>
</details>
<p>Y de está forma, podemos encontrar el estimador de <span class="math inline">\(\sigma^2\)</span>.</p>
<details>
<summary>
<b>Estimador</b>
</summary>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="regresión-múltiple.html#cb34-1" tabindex="-1"></a>varest <span class="ot">&lt;-</span> SSE <span class="sc">/</span> (<span class="fu">nrow</span>(y) <span class="sc">-</span> <span class="fu">nrow</span>(beta))</span>
<span id="cb34-2"><a href="regresión-múltiple.html#cb34-2" tabindex="-1"></a>varest</span></code></pre></div>
<pre><code>##          [,1]
## [1,] 10.62417</code></pre>
</details>
<p>Directo con las funciones de R, podemos acceder a los parámetros que se guardaron en el modelo que ya calculamos.</p>
<details>
<summary>
<b>Resumen del modelo</b>
</summary>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="regresión-múltiple.html#cb36-1" tabindex="-1"></a><span class="fu">summary</span>(M1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x1 + x2, data = datos)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.7880 -0.6629  0.4364  1.1566  7.4197 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 2.341231   1.096730   2.135 0.044170 *  
## x1          1.615907   0.170735   9.464 3.25e-09 ***
## x2          0.014385   0.003613   3.981 0.000631 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.259 on 22 degrees of freedom
## Multiple R-squared:  0.9596, Adjusted R-squared:  0.9559 
## F-statistic: 261.2 on 2 and 22 DF,  p-value: 4.687e-16</code></pre>
</details>
<p>Algunos de los parámetros almacenados en el modelo nos permiten obtener también el resultado previo.</p>
<details>
<summary>
<b>Estimador</b>
</summary>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="regresión-múltiple.html#cb38-1" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">residuals</span>(M1)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> <span class="fu">df.residual</span>(M1)</span></code></pre></div>
<pre><code>## [1] 10.62417</code></pre>
</details>
<div id="ejercicios" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Ejercicios<a href="regresión-múltiple.html#ejercicios" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Ejercicio 1:</strong> Un analista hace un estudio químico y espera que el rendimiento de cierta sustancia se vea afectado por dos factores. Se realizan 17 experimentos cuyos datos se registran en el cuadro siguiente. Por experimentos similares, se sabe que los factores <span class="math inline">\(x_1\)</span> y <span class="math inline">\(x_2\)</span> no están relacionados; por ello, el analista decide utilizar un modelo de regresión lineal múltiple. Calcule el modelo de regresión y grafíquelo sobre las observaciones.</p>
<p><em>Archivo: est_quimico.csv</em></p>
<details>
<summary>
<b>Datos Ejercicio 1</b>
</summary>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="regresión-múltiple.html#cb40-1" tabindex="-1"></a>datos2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb40-2"><a href="regresión-múltiple.html#cb40-2" tabindex="-1"></a>  <span class="at">Experimento =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">17</span>,</span>
<span id="cb40-3"><a href="regresión-múltiple.html#cb40-3" tabindex="-1"></a>  <span class="at">x1 =</span> <span class="fu">c</span>(<span class="fl">41.9</span>, <span class="fl">43.4</span>, <span class="fl">43.9</span>, <span class="fl">44.5</span>, <span class="fl">47.3</span>, <span class="fl">47.5</span>, <span class="fl">47.9</span>, <span class="fl">50.2</span>, <span class="fl">52.8</span>, <span class="fl">53.2</span>, <span class="fl">56.7</span>, <span class="fl">57.0</span>, <span class="fl">63.5</span>, <span class="fl">64.3</span>, <span class="fl">71.1</span>, <span class="fl">77.0</span>, <span class="fl">77.8</span>),</span>
<span id="cb40-4"><a href="regresión-múltiple.html#cb40-4" tabindex="-1"></a>  <span class="at">x2 =</span> <span class="fu">c</span>(<span class="fl">29.1</span>, <span class="fl">29.3</span>, <span class="fl">29.5</span>, <span class="fl">29.7</span>, <span class="fl">29.9</span>, <span class="fl">30.3</span>, <span class="fl">30.5</span>, <span class="fl">30.7</span>, <span class="fl">30.8</span>, <span class="fl">30.9</span>, <span class="fl">31.5</span>, <span class="fl">31.7</span>, <span class="fl">31.9</span>, <span class="fl">32.0</span>, <span class="fl">32.1</span>, <span class="fl">32.5</span>, <span class="fl">32.9</span>),</span>
<span id="cb40-5"><a href="regresión-múltiple.html#cb40-5" tabindex="-1"></a>  <span class="at">y  =</span> <span class="fu">c</span>(<span class="fl">251.3</span>, <span class="fl">251.3</span>, <span class="fl">248.3</span>, <span class="fl">267.5</span>, <span class="fl">273.0</span>, <span class="fl">276.5</span>, <span class="fl">270.3</span>, <span class="fl">274.9</span>, <span class="fl">285.0</span>, <span class="fl">290.0</span>, <span class="fl">297.0</span>, <span class="fl">302.5</span>, <span class="fl">304.5</span>, <span class="fl">309.3</span>, <span class="fl">321.7</span>, <span class="fl">330.7</span>, <span class="fl">349.0</span>)</span>
<span id="cb40-6"><a href="regresión-múltiple.html#cb40-6" tabindex="-1"></a>)</span>
<span id="cb40-7"><a href="regresión-múltiple.html#cb40-7" tabindex="-1"></a></span>
<span id="cb40-8"><a href="regresión-múltiple.html#cb40-8" tabindex="-1"></a>datos2</span></code></pre></div>
<pre><code>##    Experimento   x1   x2     y
## 1            1 41.9 29.1 251.3
## 2            2 43.4 29.3 251.3
## 3            3 43.9 29.5 248.3
## 4            4 44.5 29.7 267.5
## 5            5 47.3 29.9 273.0
## 6            6 47.5 30.3 276.5
## 7            7 47.9 30.5 270.3
## 8            8 50.2 30.7 274.9
## 9            9 52.8 30.8 285.0
## 10          10 53.2 30.9 290.0
## 11          11 56.7 31.5 297.0
## 12          12 57.0 31.7 302.5
## 13          13 63.5 31.9 304.5
## 14          14 64.3 32.0 309.3
## 15          15 71.1 32.1 321.7
## 16          16 77.0 32.5 330.7
## 17          17 77.8 32.9 349.0</code></pre>
</details>
<p><strong>Ejercicio 2:</strong> Repetir el ejemplo con los datos <code>datasets::trees</code> de R que proporciona mediciones
del diámetro, altura y volumen de madera en 31 cerezos negros talados.</p>
<p><strong>Ejercicio 3:</strong> Subir a Github los dos ejercicios previos tanto con solución en R como en Python. Comparar las funciones. Ventajas y desventajas de ambas.</p>
</div>
</div>
<div id="pruebas-de-hipótesis" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Pruebas de Hipótesis<a href="#pruebas-de-hip%C3%B3tesis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Cuando revisamos el <code>summary</code> del modelo, nos arroja si son significativas o no y a que nivel de significancia las variables que estamos considerando. Veamos el siguiente ejemplo.</p>
<div id="prueba-de-la-significancia-de-la-regresión" class="section level3 hasAnchor" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Prueba de la significancia de la regresión<a href="#prueba-de-la-significancia-de-la-regresi%C3%B3n" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Ejemplo:</strong> Con los datos del embotellador de bebidas gaseosas, se probará la significancia de la regresión.</p>
<details>
<summary>
<b>Sumas de Cuadrados</b>
</summary>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="regresión-múltiple.html#cb42-1" tabindex="-1"></a>SCT <span class="ot">&lt;-</span> <span class="fu">t</span>(y) <span class="sc">%*%</span> y <span class="sc">-</span>  <span class="fu">sum</span>(y)<span class="sc">**</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">nrow</span>(datos)</span>
<span id="cb42-2"><a href="regresión-múltiple.html#cb42-2" tabindex="-1"></a>SCT</span></code></pre></div>
<pre><code>##          [,1]
## [1,] 5784.543</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="regresión-múltiple.html#cb44-1" tabindex="-1"></a>SCE <span class="ot">&lt;-</span> <span class="fu">t</span>(beta) <span class="sc">%*%</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> y <span class="sc">-</span> <span class="fu">sum</span>(y)<span class="sc">**</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">nrow</span>(datos)</span>
<span id="cb44-2"><a href="regresión-múltiple.html#cb44-2" tabindex="-1"></a>SCE</span></code></pre></div>
<pre><code>##          [,1]
## [1,] 5550.811</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="regresión-múltiple.html#cb46-1" tabindex="-1"></a>SSE <span class="ot">&lt;-</span> SCT <span class="sc">-</span> SCE</span>
<span id="cb46-2"><a href="regresión-múltiple.html#cb46-2" tabindex="-1"></a>SSE</span></code></pre></div>
<pre><code>##          [,1]
## [1,] 233.7317</code></pre>
</details>
<p>Para probar</p>
<p><span class="math display">\[H_0 : \beta_1 = \beta_2=0\]</span></p>
<p>se calcula el estadístico:</p>
<details>
<summary>
<b>Estadístico F</b>
</summary>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="regresión-múltiple.html#cb48-1" tabindex="-1"></a>F0 <span class="ot">&lt;-</span> (SCE <span class="sc">/</span> (<span class="fu">ncol</span>(X) <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">/</span> (SSE <span class="sc">/</span> (<span class="fu">nrow</span>(X) <span class="sc">-</span> (<span class="fu">ncol</span>(X) <span class="sc">-</span><span class="dv">1</span>) <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb48-2"><a href="regresión-múltiple.html#cb48-2" tabindex="-1"></a>F0</span></code></pre></div>
<pre><code>##          [,1]
## [1,] 261.2351</code></pre>
</details>
<p>Como el valor de <span class="math inline">\(F_0\)</span> es mayor que el valor tabulado de <span class="math inline">\(F_{\alpha;p,n-p-1}=F_{0.05;2;22}=3.44\)</span>, se rechaza <span class="math inline">\(H_0\)</span>. Lo cual implica qye el tiempo de entrega depende del volumen de entrega y/o de la distancia.</p>
<p>Ahora, usando los modelos que ya calculamos.</p>
<details>
<summary>
<b>Sumas de cuadrados</b>
</summary>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="regresión-múltiple.html#cb50-1" tabindex="-1"></a>SCT.m<span class="ot">&lt;-</span><span class="fu">sum</span>((datos<span class="sc">$</span>y<span class="sc">-</span><span class="fu">mean</span>(datos<span class="sc">$</span>y))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb50-2"><a href="regresión-múltiple.html#cb50-2" tabindex="-1"></a>SCT.m</span></code></pre></div>
<pre><code>## [1] 5784.543</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="regresión-múltiple.html#cb52-1" tabindex="-1"></a>SCE.m <span class="ot">&lt;-</span><span class="fu">sum</span>((M1<span class="sc">$</span>fitted<span class="sc">-</span><span class="fu">mean</span>(datos<span class="sc">$</span>y))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb52-2"><a href="regresión-múltiple.html#cb52-2" tabindex="-1"></a>SCE.m</span></code></pre></div>
<pre><code>## [1] 5550.811</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="regresión-múltiple.html#cb54-1" tabindex="-1"></a>SSE.m <span class="ot">&lt;-</span><span class="fu">sum</span>(M1<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb54-2"><a href="regresión-múltiple.html#cb54-2" tabindex="-1"></a>SSE.m</span></code></pre></div>
<pre><code>## [1] 233.7317</code></pre>
</details>
<details>
<summary>
<b>Grados de libertad</b>
</summary>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="regresión-múltiple.html#cb56-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">nrow</span>(y)</span>
<span id="cb56-2"><a href="regresión-múltiple.html#cb56-2" tabindex="-1"></a>n</span></code></pre></div>
<pre><code>## [1] 25</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="regresión-múltiple.html#cb58-1" tabindex="-1"></a>GLT<span class="ot">&lt;-</span> n<span class="dv">-1</span></span>
<span id="cb58-2"><a href="regresión-múltiple.html#cb58-2" tabindex="-1"></a>GLT</span></code></pre></div>
<pre><code>## [1] 24</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="regresión-múltiple.html#cb60-1" tabindex="-1"></a>GLRes<span class="ot">&lt;-</span> <span class="fu">df.residual</span>(M1)</span>
<span id="cb60-2"><a href="regresión-múltiple.html#cb60-2" tabindex="-1"></a>GLRes</span></code></pre></div>
<pre><code>## [1] 22</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="regresión-múltiple.html#cb62-1" tabindex="-1"></a>GLR<span class="ot">&lt;-</span> GLT<span class="sc">-</span>GLRes</span>
<span id="cb62-2"><a href="regresión-múltiple.html#cb62-2" tabindex="-1"></a>GLR</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
</details>
<details>
<summary>
<b>Cuadrados medios</b>
</summary>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="regresión-múltiple.html#cb64-1" tabindex="-1"></a>CMR <span class="ot">&lt;-</span> SCE <span class="sc">/</span>GLR</span>
<span id="cb64-2"><a href="regresión-múltiple.html#cb64-2" tabindex="-1"></a>CMR</span></code></pre></div>
<pre><code>##          [,1]
## [1,] 2775.405</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="regresión-múltiple.html#cb66-1" tabindex="-1"></a>CMRes <span class="ot">&lt;-</span> SSE <span class="sc">/</span> GLRes</span>
<span id="cb66-2"><a href="regresión-múltiple.html#cb66-2" tabindex="-1"></a>CMRes</span></code></pre></div>
<pre><code>##          [,1]
## [1,] 10.62417</code></pre>
</details>
<details>
<summary>
<b>Estadístico F_0</b>
</summary>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="regresión-múltiple.html#cb68-1" tabindex="-1"></a>F0 <span class="ot">&lt;-</span> CMR<span class="sc">/</span>CMRes</span>
<span id="cb68-2"><a href="regresión-múltiple.html#cb68-2" tabindex="-1"></a>F0</span></code></pre></div>
<pre><code>##          [,1]
## [1,] 261.2351</code></pre>
</details>
<details>
<summary>
<b>p-valor</b>
</summary>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="regresión-múltiple.html#cb70-1" tabindex="-1"></a>pv <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pf</span>(F0, GLR,GLRes)</span>
<span id="cb70-2"><a href="regresión-múltiple.html#cb70-2" tabindex="-1"></a>pv</span></code></pre></div>
<pre><code>##              [,1]
## [1,] 4.440892e-16</code></pre>
</details>
<details>
<summary>
<b>Valor tabulado de F</b>
</summary>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="regresión-múltiple.html#cb72-1" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span>; df1 <span class="ot">&lt;-</span> <span class="dv">2</span>; df2 <span class="ot">&lt;-</span> <span class="dv">22</span></span>
<span id="cb72-2"><a href="regresión-múltiple.html#cb72-2" tabindex="-1"></a>F_crit <span class="ot">&lt;-</span> <span class="fu">qf</span>(<span class="dv">1</span> <span class="sc">-</span> alpha, df1, df2)</span>
<span id="cb72-3"><a href="regresión-múltiple.html#cb72-3" tabindex="-1"></a>F_crit</span></code></pre></div>
<pre><code>## [1] 3.443357</code></pre>
</details>
</div>
<div id="pruebas-sobre-coeficientes-individuales-de-regresión" class="section level3 hasAnchor" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Pruebas sobre coeficientes individuales de regresión<a href="#pruebas-sobre-coeficientes-individuales-de-regresi%C3%B3n" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Ejemplo:</strong> Usando los datos del embotellador de bebidas gaseosas, se desea evaluar la importancia de la variable regresora <em>distancia</em> (<span class="math inline">\(x_2\)</span>) dado que el regresor <em>cajas</em> (<span class="math inline">\(x_1\)</span>) está en el modelo.</p>
<details>
<summary>
<b>Estadístico t_0</b>
</summary>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="regresión-múltiple.html#cb74-1" tabindex="-1"></a>C22 <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(X) <span class="sc">%*%</span> X)[<span class="dv">3</span>,<span class="dv">3</span>]</span>
<span id="cb74-2"><a href="regresión-múltiple.html#cb74-2" tabindex="-1"></a>C22</span></code></pre></div>
<pre><code>## [1] 1.228745e-06</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="regresión-múltiple.html#cb76-1" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> beta_2 <span class="sc">/</span> <span class="fu">sqrt</span>(varest <span class="sc">*</span> C22)</span>
<span id="cb76-2"><a href="regresión-múltiple.html#cb76-2" tabindex="-1"></a>t0</span></code></pre></div>
<pre><code>##          [,1]
## [1,] 3.981313</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="regresión-múltiple.html#cb78-1" tabindex="-1"></a><span class="do">## t tabulado con confianza 95% y 22 grados de libertad</span></span>
<span id="cb78-2"><a href="regresión-múltiple.html#cb78-2" tabindex="-1"></a>tt <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="at">p =</span> <span class="fl">0.95</span> <span class="sc">+</span> <span class="fl">0.05</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> <span class="dv">22</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)</span>
<span id="cb78-3"><a href="regresión-múltiple.html#cb78-3" tabindex="-1"></a>tt</span></code></pre></div>
<pre><code>## [1] 2.073873</code></pre>
</details>
<p>Usando el modelo que ya tenemos calculado <code>M1</code> podemos obtener estos mismos resultados de la siguiente forma.</p>
<details>
<summary>
<b>Prueba sobre coeficientes</b>
</summary>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="regresión-múltiple.html#cb80-1" tabindex="-1"></a><span class="fu">summary</span>(M1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x1 + x2, data = datos)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.7880 -0.6629  0.4364  1.1566  7.4197 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 2.341231   1.096730   2.135 0.044170 *  
## x1          1.615907   0.170735   9.464 3.25e-09 ***
## x2          0.014385   0.003613   3.981 0.000631 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.259 on 22 degrees of freedom
## Multiple R-squared:  0.9596, Adjusted R-squared:  0.9559 
## F-statistic: 261.2 on 2 and 22 DF,  p-value: 4.687e-16</code></pre>
</details>
</div>
</div>
<div id="intervalos-de-confianza" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Intervalos de confianza<a href="regresión-múltiple.html#intervalos-de-confianza" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="intervalos-de-confianza-en-los-coeficientes-de-regresión" class="section level3 hasAnchor" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> Intervalos de confianza en los coeficientes de regresión<a href="#intervalos-de-confianza-en-los-coeficientes-de-regresi%C3%B3n" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Ejemplo:</strong> Usando los datos del embotellador de bebidas gaseosas, queremos calcular el intervalo de confianza del 95% para <span class="math inline">\(\beta_1\)</span>. Recordemos que el estimador puntual de <span class="math inline">\(\beta_1\)</span> es 1.6159072.</p>
<details>
<summary>
<b>Intervalo de confianza</b>
</summary>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="regresión-múltiple.html#cb82-1" tabindex="-1"></a>C11 <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(X) <span class="sc">%*%</span> X)[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb82-2"><a href="regresión-múltiple.html#cb82-2" tabindex="-1"></a></span>
<span id="cb82-3"><a href="regresión-múltiple.html#cb82-3" tabindex="-1"></a>izq <span class="ot">&lt;-</span> beta_1 <span class="sc">-</span> tt <span class="sc">*</span> <span class="fu">sqrt</span>(varest<span class="sc">*</span>C11)</span>
<span id="cb82-4"><a href="regresión-múltiple.html#cb82-4" tabindex="-1"></a>izq</span></code></pre></div>
<pre><code>##          [,1]
## [1,] 1.261825</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="regresión-múltiple.html#cb84-1" tabindex="-1"></a>der <span class="ot">&lt;-</span> beta_1 <span class="sc">+</span> tt <span class="sc">*</span> <span class="fu">sqrt</span>(varest<span class="sc">*</span>C11)</span>
<span id="cb84-2"><a href="regresión-múltiple.html#cb84-2" tabindex="-1"></a>der</span></code></pre></div>
<pre><code>##         [,1]
## [1,] 1.96999</code></pre>
</details>
</div>
<div id="intervalo-de-confianza-de-la-respuesta-media" class="section level3 hasAnchor" number="2.5.2">
<h3><span class="header-section-number">2.5.2</span> Intervalo de confianza de la respuesta media<a href="regresión-múltiple.html#intervalo-de-confianza-de-la-respuesta-media" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Ejemplo:</strong> El embotellador de bebidas gaseosas quiere establecer un intervalo de confianza del 95% para el tiempo medio de entrega para una tienda donde se requieren <span class="math inline">\(x_1=8\)</span> cajas y la distancia es de <span class="math inline">\(x_2=275\)</span> pies.</p>
Nuestro vector <span class="math inline">\(X_0\)</span> está dado por:
<details>
<summary>
<b>X0</b>
</summary>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="regresión-múltiple.html#cb86-1" tabindex="-1"></a>X0 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">8</span>, <span class="dv">275</span>), <span class="at">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb86-2"><a href="regresión-múltiple.html#cb86-2" tabindex="-1"></a>X0</span></code></pre></div>
<pre><code>##      [,1]
## [1,]    1
## [2,]    8
## [3,]  275</code></pre>
</details>
<p>El valor ajustado en ese punto es:</p>
<details>
<summary>
<b>Valor ajustado</b>
</summary>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="regresión-múltiple.html#cb88-1" tabindex="-1"></a>y0 <span class="ot">&lt;-</span> <span class="fu">t</span>(X0) <span class="sc">%*%</span> beta</span>
<span id="cb88-2"><a href="regresión-múltiple.html#cb88-2" tabindex="-1"></a>y0</span></code></pre></div>
<pre><code>##          [,1]
## [1,] 19.22432</code></pre>
</details>
<p>La varianza de <span class="math inline">\(\hat{y_0}\)</span></p>
<details>
<summary>
<b>Varianza</b>
</summary>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="regresión-múltiple.html#cb90-1" tabindex="-1"></a>var_y0 <span class="ot">&lt;-</span> varest <span class="sc">*</span> <span class="fu">t</span>(X0) <span class="sc">%*%</span> <span class="fu">solve</span>(<span class="fu">t</span>(X) <span class="sc">%*%</span> X) <span class="sc">%*%</span> X0</span>
<span id="cb90-2"><a href="regresión-múltiple.html#cb90-2" tabindex="-1"></a>var_y0</span></code></pre></div>
<pre><code>##           [,1]
## [1,] 0.5734134</code></pre>
</details>
<p>Entonces el intervalo de confianza en este punto es:</p>
<details>
<summary>
<b>Intervalo de confianza</b>
</summary>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="regresión-múltiple.html#cb92-1" tabindex="-1"></a>l_izq <span class="ot">&lt;-</span> y0 <span class="sc">-</span> tt <span class="sc">*</span> <span class="fu">sqrt</span>(var_y0) </span>
<span id="cb92-2"><a href="regresión-múltiple.html#cb92-2" tabindex="-1"></a>l_izq</span></code></pre></div>
<pre><code>##         [,1]
## [1,] 17.6539</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="regresión-múltiple.html#cb94-1" tabindex="-1"></a>l_der <span class="ot">&lt;-</span> y0 <span class="sc">+</span> tt <span class="sc">*</span> <span class="fu">sqrt</span>(var_y0) </span>
<span id="cb94-2"><a href="regresión-múltiple.html#cb94-2" tabindex="-1"></a>l_der</span></code></pre></div>
<pre><code>##          [,1]
## [1,] 20.79474</code></pre>
</details>
<p><strong>Ejemplo: </strong> Usaremos el conjunto de datos <code>data("marketing")</code> que contiene 200 observaciones de un experimento publicitario que evalúa el impacto de tres medios de anuncio en las ventas. Para cada observación se registran los presupuestos de publicidad (en miles de dólares) y las ventas obtenidas.
Variables:</p>
<ul>
<li><code>youtube</code>: presupuesto invertido en anuncios de YouTube (miles de USD).</li>
<li><code>facebook</code>: presupuesto invertido en Facebook (miles de USD).</li>
<li><code>newspaper</code>: presupuesto invertido en prensa escrita (miles de USD).</li>
<li><code>sales</code>: ventas registradas (variable respuesta).</li>
</ul>
<p>Cargamos los datos:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="regresión-múltiple.html#cb96-1" tabindex="-1"></a><span class="fu">library</span>(datarium)</span>
<span id="cb96-2"><a href="regresión-múltiple.html#cb96-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;marketing&quot;</span>)</span></code></pre></div>
<p>Exploramos rápidamente la base para ver qué variables contiene y la dimensión:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="regresión-múltiple.html#cb97-1" tabindex="-1"></a><span class="fu">str</span>(marketing)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    200 obs. of  4 variables:
##  $ youtube  : num  276.1 53.4 20.6 181.8 217 ...
##  $ facebook : num  45.4 47.2 55.1 49.6 13 ...
##  $ newspaper: num  83 54.1 83.2 70.2 70.1 ...
##  $ sales    : num  26.5 12.5 11.2 22.2 15.5 ...</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="regresión-múltiple.html#cb99-1" tabindex="-1"></a><span class="co">#?marketing</span></span></code></pre></div>
<p>Ajustamos un modelo lineal que incluya todas las variables, es decir,</p>
<p><span class="math inline">\(sales=\beta_0+\beta_1 youtube+\beta_2 facebook+ \beta_3 newspaper+\epsilon\)</span></p>
<details>
<summary>
<b>Modelo marketing</b>
</summary>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="regresión-múltiple.html#cb100-1" tabindex="-1"></a>modelo1<span class="ot">&lt;-</span><span class="fu">lm</span>(sales<span class="sc">~</span>youtube<span class="sc">+</span>facebook<span class="sc">+</span>newspaper,<span class="at">data=</span>marketing)</span>
<span id="cb100-2"><a href="regresión-múltiple.html#cb100-2" tabindex="-1"></a><span class="fu">summary</span>(modelo1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sales ~ youtube + facebook + newspaper, data = marketing)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.5932  -1.0690   0.2902   1.4272   3.3951 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.526667   0.374290   9.422   &lt;2e-16 ***
## youtube      0.045765   0.001395  32.809   &lt;2e-16 ***
## facebook     0.188530   0.008611  21.893   &lt;2e-16 ***
## newspaper   -0.001037   0.005871  -0.177     0.86    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.023 on 196 degrees of freedom
## Multiple R-squared:  0.8972, Adjusted R-squared:  0.8956 
## F-statistic: 570.3 on 3 and 196 DF,  p-value: &lt; 2.2e-16</code></pre>
</details>
<p>¿Qué se puede decir sobre la significancia de la variable <span class="math inline">\(newspaper\)</span>?</p>
<p>Veamos qué ocurre con el modelo al eliminar la variable <span class="math inline">\(newspaper\)</span></p>
<details>
<summary>
<b>Modelo marketing 2</b>
</summary>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="regresión-múltiple.html#cb102-1" tabindex="-1"></a>modelo2<span class="ot">&lt;-</span><span class="fu">lm</span>(sales<span class="sc">~</span>facebook<span class="sc">+</span>youtube,<span class="at">data=</span>marketing)</span>
<span id="cb102-2"><a href="regresión-múltiple.html#cb102-2" tabindex="-1"></a><span class="fu">summary</span>(modelo2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = sales ~ facebook + youtube, data = marketing)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.5572  -1.0502   0.2906   1.4049   3.3994 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.50532    0.35339   9.919   &lt;2e-16 ***
## facebook     0.18799    0.00804  23.382   &lt;2e-16 ***
## youtube      0.04575    0.00139  32.909   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.018 on 197 degrees of freedom
## Multiple R-squared:  0.8972, Adjusted R-squared:  0.8962 
## F-statistic: 859.6 on 2 and 197 DF,  p-value: &lt; 2.2e-16</code></pre>
</details>
<p>Lo que sigue, es hacer pruebas de hipótesis tanto en las variables como en los coeficientes de regresión.</p>
</div>
<div id="ejercicios-1" class="section level3 hasAnchor" number="2.5.3">
<h3><span class="header-section-number">2.5.3</span> Ejercicios<a href="regresión-múltiple.html#ejercicios-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Ejercicio 1:</strong> Realizar las pruebas de hipótesis sobre la significancia de la regresión y sobre los coeficientes. Encontrar los intervalos de confianza respectivos del 95%.
Para una tienda con presupuestos:
<span class="math inline">\(youtube = 150\)</span>, <span class="math inline">\(facebook = 30\)</span>, <span class="math inline">\(newspaper=20\)</span> (en miles de USD):
(a) Calcula el intervalo de confianza del 95% para la media de ventas <span class="math inline">\(\mathbb{E}(sales | X_0)\)</span>.
(b) Calcula el intervalo de predicción del 95% para una nueva observación de ventas.
(c) Comenta la diferencia entre ambos intervalos.
Subir respuesta y explicación de sus resultados a github.</p>
</div>
</div>
<div id="ejercicios-regresión-lineal-multiple" class="section level2 hasAnchor" number="2.6">
<h2><span class="header-section-number">2.6</span> Ejercicios Regresión Lineal Multiple<a href="#ejercicios-regresi%C3%B3n-lineal-multiple" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Realiza los siguientes ejercicios. En cada inciso:</p>
<ul>
<li><p>explica y comenta la solución,</p></li>
<li><p>incluye el código utilizado, y</p></li>
<li><p>añade las gráficas (plots) correspondientes con su interpretación.</p></li>
</ul>
<p>Asegúrate de que el código sea reproducible y que las figuras tengan títulos, ejes y leyendas.</p>
<p><strong>Ejercicio 1:</strong> Para los datos de la <a href="https://github.com/HaydeePeruyero/MultivariateStatisticalAnalysis/tree/main/data/Liga_nacional_de_futbol.csv">Liga Nacional de Fútbol</a>. Realizar tanto con las funciones de R y Python como con las fórmulas que usan matrices.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Ajustar un modelo de regresión lineal múltiple que relacione la cantidad de juegos ganados con las yardas por aire del equipo (<span class="math inline">\(x_2\)</span>), el porcentaje de jugadas por tierra (<span class="math inline">\(x_7\)</span>) y las yardas por tierra del contrario (<span class="math inline">\(x_8\)</span>).</p></li>
<li><p>Formar la tabla de análisis de varianza y probar la significancia de la regresión.</p></li>
<li><p>Calcular el estadístico <em>t</em> para probar las hipótesis <span class="math inline">\(H_0 : \beta_2 = 0\)</span>, <span class="math inline">\(H_0 : \beta_7 = 0\)</span> y <span class="math inline">\(H_0 : \beta_8 = 0\)</span>. ¿Qué conclusiones se pueden sacar acerca del papel de las variables <span class="math inline">\(x_2\)</span>, <span class="math inline">\(x_7\)</span> y <span class="math inline">\(x_8\)</span> en el modelo?</p></li>
<li><p>Calcular <span class="math inline">\(R^2\)</span> y <span class="math inline">\(R^2_{adj}\)</span> para este modelo.</p></li>
<li><p>Trazar una gráfica de probabilidad normal de los residuales. ¿Parece haber algún problema con la hipótesis de normalidad?</p></li>
<li><p>Trazar e interpretar una gráfica de los residuales en función de la respuesta predicha.</p></li>
<li><p>Trazar las gráficas de los residuales en función de cada una de las variables regresoras. ¿Implican esas gráficas que se especificó en forma correcta el regresor?</p></li>
<li><p>Calcular un intervalo de confianza de <span class="math inline">\(95\%\)</span> para <span class="math inline">\(\beta_7\)</span> y un intervalo de confianza de <span class="math inline">\(95\%\)</span> para la cantidad media de juegos ganados por un equipo cuando <span class="math inline">\(x_2 = 2300\)</span>, <span class="math inline">\(x_7 = 56\)</span> y <span class="math inline">\(x_8 = 2100\)</span>.</p></li>
<li><p>Ajustar un modelo a esos datos, usando solo <span class="math inline">\(x_7\)</span> y <span class="math inline">\(x_8\)</span> como regresores y probar la significancia de la regresión.</p></li>
<li><p>Calcular <span class="math inline">\(R^2\)</span> y <span class="math inline">\(R^2_{adj}\)</span>. Compararlos con los resultados del modelo anterior.</p></li>
<li><p>Calcular un intervalo de confianza de <span class="math inline">\(95\%\)</span> para <span class="math inline">\(\beta_7\)</span>. También, un intervalo de confianza de <span class="math inline">\(95\%\)</span> para la cantidad media de juegos ganados por un equipo cuando <span class="math inline">\(x_7 = 56\)</span> y <span class="math inline">\(x_8 = 2100\)</span>. Comparar las longitudes de esos intervalos de confianza con las longitudes de los correspondientes al modelo anterior.</p></li>
<li><p>¿Qué conclusiones se pueden sacar de este problema, acerca de las consecuencias de omitir un regresor importante de un modelo?</p></li>
</ol>
<p><em>Descripción de las variables:</em></p>
<p><span class="math inline">\(y\)</span>: Juegos ganados (por temporada de 14 juegos)</p>
<p><span class="math inline">\(x_{1}\)</span>: Yardas por tierra (temporada)</p>
<p><span class="math inline">\(x_{2}\)</span>: Yardas por aire (temporada)</p>
<p><span class="math inline">\(x_{3}\)</span>: Promedio de pateo (yardas/patada)</p>
<p><span class="math inline">\(x_{4}\)</span>: Porcentaje de goles de campo (GC hechos/GC intentados, temporada)</p>
<p><span class="math inline">\(x_{5}\)</span>: Diferencia de pérdidas de balón (pérdidas ganadas/pérdidas perdidas)</p>
<p><span class="math inline">\(x_{6}\)</span>: Yardas de castigo (temporada)</p>
<p><span class="math inline">\(x_{7}\)</span>: Porcentaje de carreras (jugadas por tierra/jugadas totales)</p>
<p><span class="math inline">\(x_{8}\)</span>: Yardas por tierra del contrario (temporada)</p>
<p><span class="math inline">\(x_{9}\)</span>: Yardas por aire del contrario (temporada)</p>
<p><strong>Ejericio 2:</strong> Véase los datos de <a href="https://github.com/HaydeePeruyero/MultivariateStatisticalAnalysis/tree/main/data/Rendimiento_de_gasolina.csv">rendimiento de gasolina</a>. Realizar el ejercicio en R.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Ajustar un modelo de regresión lineal múltiple que relacione el rendimiento de la gasolina <em>y</em>, en millas por galón, la cilindrada del motor (<span class="math inline">\(x_1\)</span>) y la cantidad de gargantas del carburador (<span class="math inline">\(x_6\)</span>).</p></li>
<li><p>Formar la tabla de análisis de varianza y probar la significancia de la regresión.</p></li>
<li><p>Calcular <span class="math inline">\(R^2\)</span> y <span class="math inline">\(R^2_{adj}\)</span> para este modelo. Compararlas con las <span class="math inline">\(R^2\)</span> y <span class="math inline">\(R^2_{adj}\)</span> Ajustado para el modelo de regresión lineal simple, que relaciona las millas con la cilindrada.</p></li>
<li><p>Determinar un intervalo de confianza para <span class="math inline">\(\beta_1\)</span>.</p></li>
<li><p>Determinar un intervalo de confianza de <span class="math inline">\(95\%\)</span> para el rendimiento promedio de la gasolina, cuando <span class="math inline">\(x_1 = 225 pulg^3\)</span> y <span class="math inline">\(x_6 = 2\)</span> gargantas.</p></li>
<li><p>Determinar un intervalo de predicción de <span class="math inline">\(95\%\)</span> para una nueva observación de rendimiento de gasolina, cuando <span class="math inline">\(x_1 = 225 pulg^3\)</span> y <span class="math inline">\(x_6 = 2\)</span> gargantas.</p></li>
<li><p>Considerar el modelo de regresión lineal simple, que relaciona las millas con la cilindrada. Construir un intervalo de confianza de <span class="math inline">\(95\%\)</span> para el rendimiento promedio de la gasolina y un intervalo de predicción para el rendimiento, cuando <span class="math inline">\(x_1 = 225 pulg^3\)</span>. Comparar las longitudes de estos intervalos con los intervalos obtenidos en los dos incisos anteriores. ¿Tiene ventajas agregar <span class="math inline">\(x_6\)</span> al modelo?</p></li>
<li><p>Trazar una gráfica de probabilidad normal de los residuales. ¿Parece haber algún problema con la hipótesis de normalidad?</p></li>
<li><p>Trazar e interpretar una gráfica de los residuales en función de la respuesta predicha.</p></li>
<li><p>Trazar las gráficas de los residuales en función de cada una de las variables regresoras. ¿Implican esas gráficas que se especificó en forma correcta el regresor?</p></li>
</ol>
<p><em>Descripción de variables:</em> Variables (Fuente: Motor Trend, 1975)</p>
<p><span class="math inline">\(y:\)</span> Millas/galón</p>
<p><span class="math inline">\(x_1:\)</span> Cilindrada (pulgadas cúbicas)</p>
<p><span class="math inline">\(x_2:\)</span> Potencia (Hp)</p>
<p><span class="math inline">\(x_3:\)</span> Par de torsión (pies-lb)</p>
<p><span class="math inline">\(x_4:\)</span> Relación de compresión</p>
<p><span class="math inline">\(x_5:\)</span> Relación de eje trasero</p>
<p><span class="math inline">\(x_6:\)</span> Carburador (gargantas)</p>
<p><span class="math inline">\(x_7:\)</span> Número de velocidades en la transmisión</p>
<p><span class="math inline">\(x_8:\)</span> Longitud total (pulgadas)</p>
<p><span class="math inline">\(x_9:\)</span> Ancho (pulgadas)</p>
<p><span class="math inline">\(x_{10}:\)</span> Peso (lb)</p>
<p><span class="math inline">\(x_{11}:\)</span> Tipo de transmisión (1 = automática, 0 = manual)</p>
<p><strong>Ejercicio 3:</strong> Véase los datos sobre <a href="https://github.com/HaydeePeruyero/MultivariateStatisticalAnalysis/tree/main/data/Precios_de_viviendas">precios de viviendas</a>. Realizar el ejercicio en Python.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Ajustar un modelo de regresión lineal múltiple que relacione el precio de venta con los nueve regresores.</p></li>
<li><p>Probar la significancia de la regresión.¿Qué conclusiones se pueden sacar?</p></li>
<li><p>Usar pruebas t para evaluar la contribución de cada regresor al modelo.</p></li>
<li><p>Calcular <span class="math inline">\(R^2\)</span> y <span class="math inline">\(R^2_{adj}\)</span> para este modelo.</p></li>
<li><p>¿Cuál es la contribución del tamaño del lote y el espacio vital para el modelo, dado que se incluyeron todos los demás regresores?.</p></li>
<li><p>En este modelo, ¿la colinealidad es un problema potencial?</p></li>
<li><p>Trazar una gráfica de probabilidad normal de los residuales. ¿Parece haber algún problema con la hipótesis de normalidad?</p></li>
<li><p>Trazar e interpretar una gráfica de los residuales en función de la respuesta predicha.</p></li>
<li><p>Trazar las gráficas de los residuales en función de cada una de las variables regresoras. ¿Implican esas gráficas que se especificó en forma correcta el regresor?.</p></li>
</ol>
<p><em>Descripción de las variables:</em></p>
<p><span class="math inline">\(y\)</span>: Precio de venta de la casa / 1000</p>
<p><span class="math inline">\(x_{1}\)</span>: Impuestos (locales, escuela, municipal) / 1000</p>
<p><span class="math inline">\(x_{2}\)</span>: Cantidad de baños</p>
<p><span class="math inline">\(x_{3}\)</span>: Tamaño del terreno (pies cuadrados <span class="math inline">\(\times\)</span> 1000)</p>
<p><span class="math inline">\(x_{4}\)</span>: Superficie construida (pies cuadrados <span class="math inline">\(\times\)</span> 1000)</p>
<p><span class="math inline">\(x_{5}\)</span>: Cantidad de cajones en cochera</p>
<p><span class="math inline">\(x_{6}\)</span>: Cantidad de habitaciones</p>
<p><span class="math inline">\(x_{7}\)</span>: Cantidad de recámaras</p>
<p><span class="math inline">\(x_{8}\)</span>: Edad de la casa (años)</p>
<p><span class="math inline">\(x_{9}\)</span>: Cantidad de chimeneas</p>
<p><strong>Ejercicio 4:</strong> Explica lo siguiente.</p>
<ol style="list-style-type: lower-alpha">
<li><p>¿Qué supuestos del modelo de regresión lineal múltiple deben verificarse?</p></li>
<li><p>¿Cómo se interpretan los intervalos de confianza? Si construimos un intervalo de confianza del 95% para un coeficiente <span class="math inline">\(\beta_j\)</span>, ¿cuál sería la lectura correcta o interpretación correcta sobre este intervalo?</p></li>
<li><p>Describe los métodos de selección de variables y sus ventajas y desventajas:</p></li>
<li><p>Selección hacia adelante (forward)</p></li>
</ol>
<ol start="2" style="list-style-type: lower-roman">
<li><p>Selección hacia atrás (backward)</p></li>
<li><p>selección por pasos (stepwise) y/o mejor subconjunto (best subset)</p></li>
</ol>
<p>Explica cómo se utilizan para elegir el modelo final.</p>
<p><strong>Ejercicio 5:</strong> Para los datos del ejercicio 1 de la liga de Futbol. Realizar el ejercicio en R y Python.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Usar el algoritmo de selección hacia adelante para seleccionar un modelo de regresión.</p></li>
<li><p>Usar el algoritmo de selección hacia atrás para seleccionar un modelo de regresión.</p></li>
<li><p>Usar el algoritmo de regresión por pasos para seleccionar un modelo de regresión.</p></li>
<li><p>Comenta los modelos finales en cada uno de los casos anteriores. ¿Cuál tiene más sentido? ¿Cuál modelo usarían?</p></li>
</ol>
</div>
<div id="validación-de-supuestos" class="section level2 hasAnchor" number="2.7">
<h2><span class="header-section-number">2.7</span> Validación de Supuestos<a href="#validaci%C3%B3n-de-supuestos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Ejemplo:</strong> Se llevó a cabo un conjunto de ensayos experimentales con un horno para determinar una forma de predecir el tiempo de cocción, <span class="math inline">\(y\)</span>, a diferentes niveles de ancho del horno, <span class="math inline">\(x_1\)</span>, y a diferentes temperaturas, <span class="math inline">\(x_2\)</span>. Se registraron los siguientes datos:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="regresión-múltiple.html#cb104-1" tabindex="-1"></a>yp <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">6.40</span>, <span class="fl">15.05</span>, <span class="fl">18.75</span>, <span class="fl">30.25</span>, <span class="fl">44.85</span>, <span class="fl">48.85</span>, <span class="fl">51.55</span>, <span class="fl">61.50</span>, <span class="fl">100.44</span>, <span class="fl">111.42</span>)</span>
<span id="cb104-2"><a href="regresión-múltiple.html#cb104-2" tabindex="-1"></a>x1 <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">1.32</span>, <span class="fl">2.69</span>, <span class="fl">3.56</span>, <span class="fl">4.41</span>, <span class="fl">5.35</span>, <span class="fl">6.20</span>, <span class="fl">7.12</span>, <span class="fl">8.87</span>, <span class="fl">9.80</span>, <span class="fl">10.65</span>)</span>
<span id="cb104-3"><a href="regresión-múltiple.html#cb104-3" tabindex="-1"></a>x2 <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">1.15</span>, <span class="fl">3.40</span>, <span class="fl">4.10</span>, <span class="fl">8.75</span>, <span class="fl">14.82</span>, <span class="fl">15.15</span>, <span class="fl">15.32</span>, <span class="fl">18.18</span>, <span class="fl">35.19</span>, <span class="fl">40.40</span>)</span>
<span id="cb104-4"><a href="regresión-múltiple.html#cb104-4" tabindex="-1"></a>datos<span class="ot">&lt;-</span><span class="fu">data.frame</span>(yp, x1, x2)</span>
<span id="cb104-5"><a href="regresión-múltiple.html#cb104-5" tabindex="-1"></a><span class="fu">kable</span>(datos, <span class="at">caption =</span> <span class="st">&quot;Factores que influyen en el tiempo de coccion segun diferentes niveles de ancho del horno y diferentes temperaturas&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-40">Table 2.1: </span>Factores que influyen en el tiempo de coccion segun diferentes niveles de ancho del horno y diferentes temperaturas</caption>
<thead>
<tr class="header">
<th align="right">yp</th>
<th align="right">x1</th>
<th align="right">x2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">6.40</td>
<td align="right">1.32</td>
<td align="right">1.15</td>
</tr>
<tr class="even">
<td align="right">15.05</td>
<td align="right">2.69</td>
<td align="right">3.40</td>
</tr>
<tr class="odd">
<td align="right">18.75</td>
<td align="right">3.56</td>
<td align="right">4.10</td>
</tr>
<tr class="even">
<td align="right">30.25</td>
<td align="right">4.41</td>
<td align="right">8.75</td>
</tr>
<tr class="odd">
<td align="right">44.85</td>
<td align="right">5.35</td>
<td align="right">14.82</td>
</tr>
<tr class="even">
<td align="right">48.85</td>
<td align="right">6.20</td>
<td align="right">15.15</td>
</tr>
<tr class="odd">
<td align="right">51.55</td>
<td align="right">7.12</td>
<td align="right">15.32</td>
</tr>
<tr class="even">
<td align="right">61.50</td>
<td align="right">8.87</td>
<td align="right">18.18</td>
</tr>
<tr class="odd">
<td align="right">100.44</td>
<td align="right">9.80</td>
<td align="right">35.19</td>
</tr>
<tr class="even">
<td align="right">111.42</td>
<td align="right">10.65</td>
<td align="right">40.40</td>
</tr>
</tbody>
</table>
<ul>
<li><p>Variable dependiente <span class="math inline">\(y =\)</span> tiempo de cocción</p></li>
<li><p>Variable independiente <span class="math inline">\(x_1 =\)</span> ancho del horno</p></li>
<li><p>Variable independiente <span class="math inline">\(x_2 =\)</span> diferentes temperaturas</p></li>
</ul>
<p>Vamos a visualizar los datos:</p>
<details>
<summary>
<b>Plot</b>
</summary>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="regresión-múltiple.html#cb105-1" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> datos, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> yp)) <span class="sc">+</span></span>
<span id="cb105-2"><a href="regresión-múltiple.html#cb105-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;forestgreen&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb105-3"><a href="regresión-múltiple.html#cb105-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title  =</span>  <span class="st">&#39;yp ~ x1&#39;</span>, <span class="at">x  =</span>  <span class="st">&#39;x1&#39;</span>) <span class="sc">+</span></span>
<span id="cb105-4"><a href="regresión-múltiple.html#cb105-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb105-5"><a href="regresión-múltiple.html#cb105-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb105-6"><a href="regresión-múltiple.html#cb105-6" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>)) </span>
<span id="cb105-7"><a href="regresión-múltiple.html#cb105-7" tabindex="-1"></a></span>
<span id="cb105-8"><a href="regresión-múltiple.html#cb105-8" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> datos, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x2, <span class="at">y =</span> yp)) <span class="sc">+</span></span>
<span id="cb105-9"><a href="regresión-múltiple.html#cb105-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;orange&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb105-10"><a href="regresión-múltiple.html#cb105-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title  =</span>  <span class="st">&#39;yp ~ x2&#39;</span>, <span class="at">x  =</span>  <span class="st">&#39;x2&#39;</span>) <span class="sc">+</span></span>
<span id="cb105-11"><a href="regresión-múltiple.html#cb105-11" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb105-12"><a href="regresión-múltiple.html#cb105-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb105-13"><a href="regresión-múltiple.html#cb105-13" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb105-14"><a href="regresión-múltiple.html#cb105-14" tabindex="-1"></a></span>
<span id="cb105-15"><a href="regresión-múltiple.html#cb105-15" tabindex="-1"></a>g1<span class="sc">+</span>g2</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;
## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<img src="MultivariateStatisticalAnalysis_files/figure-html/unnamed-chunk-41-1.png" width="672" />
</details>
<p>Ahora, vamos a analizar algunos de los supuestos.</p>
<div id="multicolinealidad" class="section level3 hasAnchor" number="2.7.1">
<h3><span class="header-section-number">2.7.1</span> Multicolinealidad<a href="regresión-múltiple.html#multicolinealidad" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<details>
<summary>
<b>Multicolinealidad</b>
</summary>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="regresión-múltiple.html#cb107-1" tabindex="-1"></a>variables <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x1,x2)</span>
<span id="cb107-2"><a href="regresión-múltiple.html#cb107-2" tabindex="-1"></a>m_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(variables,<span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb107-3"><a href="regresión-múltiple.html#cb107-3" tabindex="-1"></a>m_cor</span></code></pre></div>
<pre><code>##           x1        x2
## x1 1.0000000 0.9375592
## x2 0.9375592 1.0000000</code></pre>
</details>
<details>
<summary>
<b>Plot</b>
</summary>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="regresión-múltiple.html#cb109-1" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code></pre></div>
<pre><code>## corrplot 0.95 loaded</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="regresión-múltiple.html#cb111-1" tabindex="-1"></a><span class="fu">corrplot</span>(m_cor)</span></code></pre></div>
<img src="MultivariateStatisticalAnalysis_files/figure-html/unnamed-chunk-43-1.png" width="672" />
</details>
<p>Hay una fuerte correlación entre las variables, lo cual es un problema dado que las variables deberían ser independientes.</p>
<p>Vamos a construir dos modelos.</p>
<details>
<summary>
<b>Modelos</b>
</summary>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="regresión-múltiple.html#cb112-1" tabindex="-1"></a>modelo1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> yp <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> datos)</span>
<span id="cb112-2"><a href="regresión-múltiple.html#cb112-2" tabindex="-1"></a></span>
<span id="cb112-3"><a href="regresión-múltiple.html#cb112-3" tabindex="-1"></a><span class="fu">summary</span>(modelo1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = yp ~ x1 + x2, data = datos)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.8475 -0.3438  0.0043  0.2554  1.1578 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  0.57723    0.59865   0.964    0.367    
## x1           2.70957    0.19935  13.592 2.75e-06 ***
## x2           2.05033    0.04743  43.227 9.26e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6481 on 7 degrees of freedom
## Multiple R-squared:  0.9997, Adjusted R-squared:  0.9997 
## F-statistic: 1.304e+04 on 2 and 7 DF,  p-value: 3.166e-13</code></pre>
</details>
<p>El intercepto parece no ser significativo. Vamos a construir un segundo modelo usando solo <span class="math inline">\(x_2\)</span> que parece ser más significativa.</p>
<details>
<summary>
<b>Modelo 2</b>
</summary>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="regresión-múltiple.html#cb114-1" tabindex="-1"></a>modelo2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> yp <span class="sc">~</span> x2, <span class="at">data =</span> datos)</span>
<span id="cb114-2"><a href="regresión-múltiple.html#cb114-2" tabindex="-1"></a></span>
<span id="cb114-3"><a href="regresión-múltiple.html#cb114-3" tabindex="-1"></a><span class="fu">summary</span>(modelo2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = yp ~ x2, data = datos)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.0226 -1.7338 -0.3497  1.0695  5.8668 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  7.36967    1.61355   4.567  0.00183 ** 
## x2           2.65476    0.08077  32.869 8.01e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.173 on 8 degrees of freedom
## Multiple R-squared:  0.9926, Adjusted R-squared:  0.9917 
## F-statistic:  1080 on 1 and 8 DF,  p-value: 8.005e-10</code></pre>
</details>
<p>El ANOVA nos puede ayudar a ver cual modelo es más significativo. Se usan las hipótesis siguientes:</p>
<p><span class="math inline">\(H_0:\)</span> Las variables que eliminamos no tienen significancia.</p>
<p><span class="math inline">\(H_1:\)</span> Las variables son significativas.</p>
<p>Si el nuevo modelo es una mejora del modelo original, entonces no podemos rechazar <span class="math inline">\(H_0\)</span>. Si ese no es el caso, significa que esas variables fueron significativas; por lo tanto rechazamos <span class="math inline">\(H_0\)</span>.</p>
<details>
<summary>
<b>ANOVA</b>
</summary>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="regresión-múltiple.html#cb116-1" tabindex="-1"></a><span class="fu">anova</span>(modelo1, modelo2)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: yp ~ x1 + x2
## Model 2: yp ~ x2
##   Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
## 1      7  2.940                                  
## 2      8 80.532 -1   -77.592 184.74 2.745e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</details>
<p>Como el p-valor es muy pequeño, menor al valor de significancia 0.05, entonces rechazamos la hipótesis nula, lo que nos dice que el segundo modelo no es una mejora del primero.</p>
<p>Como desde el inicio vimos que el coeficiente correspondiente a <span class="math inline">\(\beta_0\)</span> no era significativo, vamos a eliminarlo.</p>
<details>
<summary>
<b>Modelo 3</b>
</summary>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="regresión-múltiple.html#cb118-1" tabindex="-1"></a>modelo3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> yp <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">-</span><span class="dv">1</span>, <span class="at">data =</span> datos)</span>
<span id="cb118-2"><a href="regresión-múltiple.html#cb118-2" tabindex="-1"></a></span>
<span id="cb118-3"><a href="regresión-múltiple.html#cb118-3" tabindex="-1"></a><span class="fu">summary</span>(modelo3)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = yp ~ x1 + x2 - 1, data = datos)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -0.8103 -0.3698  0.1963  0.3955  1.1807 
## 
## Coefficients:
##    Estimate Std. Error t value Pr(&gt;|t|)    
## x1  2.87003    0.10927   26.27 4.74e-09 ***
## x2  2.02140    0.03657   55.28 1.27e-11 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6452 on 8 degrees of freedom
## Multiple R-squared:  0.9999, Adjusted R-squared:  0.9999 
## F-statistic: 4.188e+04 on 2 and 8 DF,  p-value: &lt; 2.2e-16</code></pre>
</details>
</div>
<div id="normalidad-en-los-residuales" class="section level3 hasAnchor" number="2.7.2">
<h3><span class="header-section-number">2.7.2</span> Normalidad en los residuales<a href="regresión-múltiple.html#normalidad-en-los-residuales" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Recordemos que los residuos se calculan como la diferencia entre el valor observado <span class="math inline">\((y)\)</span> y el valor predicho <span class="math inline">\((\hat{y})\)</span> para cada punto de datos, es decir:</p>
<p><span class="math inline">\(e = y - \hat{y}\)</span></p>
<p>Vamos a hacer un plot de los residuales.</p>
<details>
<summary>
<b>QQ-plot</b>
</summary>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="regresión-múltiple.html#cb120-1" tabindex="-1"></a>residuales <span class="ot">=</span> modelo3<span class="sc">$</span>residuals</span>
<span id="cb120-2"><a href="regresión-múltiple.html#cb120-2" tabindex="-1"></a></span>
<span id="cb120-3"><a href="regresión-múltiple.html#cb120-3" tabindex="-1"></a><span class="do">## Q-Q plot</span></span>
<span id="cb120-4"><a href="regresión-múltiple.html#cb120-4" tabindex="-1"></a><span class="fu">qqnorm</span>(residuales)</span>
<span id="cb120-5"><a href="regresión-múltiple.html#cb120-5" tabindex="-1"></a><span class="fu">qqline</span>(residuales)</span></code></pre></div>
<img src="MultivariateStatisticalAnalysis_files/figure-html/unnamed-chunk-48-1.png" width="672" />
</details>
<p>Otra forma de obtener este plot es la siguiente.</p>
<details>
<summary>
<b>Plots supuestos</b>
</summary>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="regresión-múltiple.html#cb121-1" tabindex="-1"></a><span class="fu">plot</span>(modelo3)</span></code></pre></div>
<img src="MultivariateStatisticalAnalysis_files/figure-html/unnamed-chunk-49-1.png" width="672" /><img src="MultivariateStatisticalAnalysis_files/figure-html/unnamed-chunk-49-2.png" width="672" /><img src="MultivariateStatisticalAnalysis_files/figure-html/unnamed-chunk-49-3.png" width="672" /><img src="MultivariateStatisticalAnalysis_files/figure-html/unnamed-chunk-49-4.png" width="672" />
</details>
<p>El test de Shapiro-Wilks plantea la hipótesis nula que una muestra proviene de una distribución normal. Eligimos un nivel de significanza, por ejemplo <span class="math inline">\(0.05\)</span>, y tenemos una hipótesis alternativa que sostiene que la distribución no es normal. Tenemos entonces lo siguiente:</p>
<p><span class="math inline">\(H_0:\)</span> La distribución es normal.</p>
<p><span class="math inline">\(H_1:\)</span> La distribución no es normal.</p>
<details>
<summary>
<b>Test Shapiro-Wilks</b>
</summary>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="regresión-múltiple.html#cb122-1" tabindex="-1"></a><span class="fu">shapiro.test</span>(residuales)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  residuales
## W = 0.95058, p-value = 0.6754</code></pre>
</details>
<p>Como el p-valor es más grande que el valor de significancia, no podemos rechazar la hipótesis nula, por lo tanto los residuales siguen una distribución normal.</p>
</div>
<div id="homocedasticidad" class="section level3 hasAnchor" number="2.7.3">
<h3><span class="header-section-number">2.7.3</span> Homocedasticidad<a href="regresión-múltiple.html#homocedasticidad" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Homocedasticidad = varianza constante</p>
<ul>
<li><p><em>Correcto:</em> Si los residuales están dispersos uniformemente a lo largo de todos los valores predichos.</p></li>
<li><p><em>Problema:</em> Si vemos un patrón de embudo (residuales pequeños para predichos bajos y grandes para predichos altos, o viceversa). Esto indica heterocedasticidad.</p></li>
</ul>
<p>Linealidad y errores independientes: Si se notan curvas, arcos o patrones sistemáticos, podría indicar que:</p>
<ul>
<li><p>La relación no es estrictamente lineal.</p></li>
<li><p>Falta alguna variable importante en el modelo.</p></li>
<li><p>O hay correlación entre errores.</p></li>
</ul>
<p>Una forma de verlo es con el plot de residuales vs valores predichos.</p>
<details>
<summary>
<b>Plots</b>
</summary>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="regresión-múltiple.html#cb124-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb124-2"><a href="regresión-múltiple.html#cb124-2" tabindex="-1"></a><span class="fu">plot</span>(modelo3)</span></code></pre></div>
<p><img src="MultivariateStatisticalAnalysis_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<p>En R, existe la función <code>bptest()</code>, que es el test de Breusch-Pagan para la heterocedasticidad. Esta función toma como entrada un modelo de regresión y devuelve el resultado de la prueba de hipótesis para la homocedasticidad de los residuos.</p>
<p><span class="math inline">\(H_0:\)</span> los residuos tienen varianza constante (homocedasticidad)</p>
<p><span class="math inline">\(H_1\)</span>: hay heterocedasticidad en los residuos</p>
<p>El resultado incluye el valor del estadístico de prueba (el valor de la prueba de Breusch-Pagan), el p-valor y el número de grados de libertad. Si el p-valor es menor que el nivel de significancia elegido, se rechaza la hipótesis nula de homocedasticidad y se concluye que hay heterocedasticidad en los residuos.</p>
<details>
<summary>
<b>Breusch-Pagan</b>
</summary>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="regresión-múltiple.html#cb125-1" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span></code></pre></div>
<pre><code>## Cargando paquete requerido: zoo</code></pre>
<pre><code>## 
## Adjuntando el paquete: &#39;zoo&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="regresión-múltiple.html#cb129-1" tabindex="-1"></a><span class="fu">bptest</span>(modelo3)</span></code></pre></div>
<pre><code>## 
##  studentized Breusch-Pagan test
## 
## data:  modelo3
## BP = 5.7517, df = 1, p-value = 0.01647</code></pre>
</details>
<p>Entonces como el p-valor es menor al valor de significancia <span class="math inline">\(0.05\)</span>, rechazamos la hipótesis nula y podemos decir que existe heterocedasticidad en los residuales.</p>
<p>La heterocedasticidad es un problema porque la regresión de mínimos cuadrados ordinarios asume que todos los residuales se extraen de una población que tiene una varianza constante (homocedasticidad).</p>
<p>Una forma de corregirlo es haciendo una transformación de los datos. Vamos a transformar la variable <span class="math inline">\(x_1\)</span>.
<em>Nota:</em> Estas transformaciones deben de justificarse y explicar el porque.</p>
<details>
<summary>
<b>Modelo 4</b>
</summary>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="regresión-múltiple.html#cb131-1" tabindex="-1"></a>modelo4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> yp <span class="sc">~</span> <span class="fu">log</span>(x1) <span class="sc">+</span> x2 <span class="sc">-</span><span class="dv">1</span>, <span class="at">data =</span> datos)</span>
<span id="cb131-2"><a href="regresión-múltiple.html#cb131-2" tabindex="-1"></a></span>
<span id="cb131-3"><a href="regresión-múltiple.html#cb131-3" tabindex="-1"></a><span class="fu">summary</span>(modelo4)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = yp ~ log(x1) + x2 - 1, data = datos)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.4546 -0.7961 -0.3458  0.9207  2.5270 
## 
## Coefficients:
##         Estimate Std. Error t value Pr(&gt;|t|)    
## log(x1)  7.52724    0.72213   10.42 6.22e-06 ***
## x2       2.34013    0.06306   37.11 3.05e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.578 on 8 degrees of freedom
## Multiple R-squared:  0.9994, Adjusted R-squared:  0.9993 
## F-statistic:  6997 on 2 and 8 DF,  p-value: 1.065e-13</code></pre>
</details>
<p>Si realizamos la prueba de la homocedasticidad.</p>
<details>
<summary>
<b>Test</b>
</summary>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="regresión-múltiple.html#cb133-1" tabindex="-1"></a><span class="fu">bptest</span>(modelo4)</span></code></pre></div>
<pre><code>## 
##  studentized Breusch-Pagan test
## 
## data:  modelo4
## BP = 0.13878, df = 1, p-value = 0.7095</code></pre>
</details>
<p>Vemos que ahora el p-valor es más grande que el valor de significancia, lo cual nos indica que no podemos rechazar <span class="math inline">\(H_0\)</span>, es decir ahora si podemos asumir que hay homocedasticidad.</p>
<p>En el modelo final, tendríamos <span class="math inline">\(\beta_0=0\)</span>, <span class="math inline">\(\beta_1*=\)</span> 7.5272361 y <span class="math inline">\(\beta_2=\)</span> 2.3401283.</p>
<details>
<summary>
<b>Plots finales</b>
</summary>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="regresión-múltiple.html#cb135-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb135-2"><a href="regresión-múltiple.html#cb135-2" tabindex="-1"></a><span class="fu">plot</span>(modelo4)</span></code></pre></div>
<img src="MultivariateStatisticalAnalysis_files/figure-html/unnamed-chunk-55-1.png" width="672" />
</details>
<p>Otras dos pruebas que se pueden usar son <code>fligner.test</code> y <code>leveneTest</code>.</p>
</div>
<div id="no-autocorrelación" class="section level3 hasAnchor" number="2.7.4">
<h3><span class="header-section-number">2.7.4</span> No autocorrelación<a href="#no-autocorrelaci%C3%B3n" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Una forma de revisar este supuesto es con el test de Durbin-Watson. Las hipótesis que se tienen son:</p>
<p><span class="math inline">\(H_0:\)</span> No hay autocorrelación en los errores (los residuales son independientes).</p>
<p><span class="math inline">\(H_1:\)</span> Hay autocorrelación en los errores (generalmente, autocorrelación positiva de primer orden).</p>
<p>El estadístico DW toma valores entre 0 y 4:</p>
<ul>
<li><p><span class="math inline">\(DW\)</span> aproximadamente 2, entonces no hay autocorrelación (se cumple el supuesto).</p></li>
<li><p><span class="math inline">\(DW &lt; 2\)</span>, entonces indica autocorrelación positiva (los errores tienden a repetirse).</p></li>
<li><p><span class="math inline">\(DW &gt; 2\)</span>, entonces indica autocorrelación negativa (los errores tienden a alternar signo).</p></li>
</ul>
<details>
<summary>
<b>Test D-W</b>
</summary>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="regresión-múltiple.html#cb136-1" tabindex="-1"></a><span class="fu">dwtest</span>(modelo4)</span></code></pre></div>
<pre><code>## 
##  Durbin-Watson test
## 
## data:  modelo4
## DW = 1.036, p-value = 0.02046
## alternative hypothesis: true autocorrelation is greater than 0</code></pre>
</details>
</div>
<div id="predicciones" class="section level3 hasAnchor" number="2.7.5">
<h3><span class="header-section-number">2.7.5</span> Predicciones<a href="regresión-múltiple.html#predicciones" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Vamos a predecir por último un valor. Para <span class="math inline">\(2.10\)</span> de ancho del horno y una temperatura de <span class="math inline">\(3.10\)</span> , ¿cuánto seria el tiempo de cocción?</p>
<details>
<summary>
<b>Predicciónes</b>
</summary>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="regresión-múltiple.html#cb138-1" tabindex="-1"></a>nuevo.dato <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> <span class="fl">2.10</span>, <span class="at">x2 =</span> <span class="fl">3.10</span>)</span>
<span id="cb138-2"><a href="regresión-múltiple.html#cb138-2" tabindex="-1"></a></span>
<span id="cb138-3"><a href="regresión-múltiple.html#cb138-3" tabindex="-1"></a>prediccion <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo4, <span class="at">newdata =</span> nuevo.dato)</span>
<span id="cb138-4"><a href="regresión-múltiple.html#cb138-4" tabindex="-1"></a></span>
<span id="cb138-5"><a href="regresión-múltiple.html#cb138-5" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">&quot;La cantidad estimada de tiempo de coccion es:&quot;</span>, <span class="fu">round</span>(prediccion, <span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] &quot;La cantidad estimada de tiempo de coccion es: 12.84&quot;</code></pre>
</details>
</div>
<div id="ejercicios-2" class="section level3 hasAnchor" number="2.7.6">
<h3><span class="header-section-number">2.7.6</span> Ejercicios<a href="regresión-múltiple.html#ejercicios-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Ejercicio 1:</strong> Para los datos de <code>Datarium marketing</code>, analiza los supuestos. Explica tus resultados y sube tus respuestas a github.</p>
</div>
</div>
<div id="análisis-de-varianza" class="section level2 hasAnchor" number="2.8">
<h2><span class="header-section-number">2.8</span> Análisis de Varianza<a href="#an%C3%A1lisis-de-varianza" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Ejemplo 1: </strong> Supongamos que un cierto tipo de motor de cohete se fabrica uniendo un propulsor tipo A y un propulsor tipo B. La fuerza del enlace entre los dos propulsores es una característica de importancia y se sospecha que está relacionada con la edad (en semanas) del lote del propulsor tipo B. Se tiene una muestra de tamaño 20 de la fuerza del enlace y la edad del lote del propulsor tipo B que fue utilizado.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="regresión-múltiple.html#cb140-1" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb140-2"><a href="regresión-múltiple.html#cb140-2" tabindex="-1"></a>  <span class="at">Fuerza_enlace =</span> <span class="fu">c</span>(</span>
<span id="cb140-3"><a href="regresión-múltiple.html#cb140-3" tabindex="-1"></a>    <span class="fl">2158.70</span>, <span class="fl">1678.15</span>, <span class="fl">2316.00</span>, <span class="fl">2061.30</span>, <span class="fl">2207.50</span>,</span>
<span id="cb140-4"><a href="regresión-múltiple.html#cb140-4" tabindex="-1"></a>    <span class="fl">1708.30</span>, <span class="fl">1784.70</span>, <span class="fl">2575.00</span>, <span class="fl">2357.90</span>, <span class="fl">2256.70</span>,</span>
<span id="cb140-5"><a href="regresión-múltiple.html#cb140-5" tabindex="-1"></a>    <span class="fl">2165.20</span>, <span class="fl">2399.55</span>, <span class="fl">1779.80</span>, <span class="fl">2336.75</span>, <span class="fl">1765.30</span>,</span>
<span id="cb140-6"><a href="regresión-múltiple.html#cb140-6" tabindex="-1"></a>    <span class="fl">2053.50</span>, <span class="fl">2414.40</span>, <span class="fl">2200.50</span>, <span class="fl">2654.20</span>, <span class="fl">1753.70</span></span>
<span id="cb140-7"><a href="regresión-múltiple.html#cb140-7" tabindex="-1"></a>  ),</span>
<span id="cb140-8"><a href="regresión-múltiple.html#cb140-8" tabindex="-1"></a>  <span class="at">Edad_lote =</span> <span class="fu">c</span>(</span>
<span id="cb140-9"><a href="regresión-múltiple.html#cb140-9" tabindex="-1"></a>    <span class="fl">15.50</span>, <span class="fl">23.75</span>, <span class="fl">8.00</span>, <span class="fl">17.00</span>, <span class="fl">5.50</span>,</span>
<span id="cb140-10"><a href="regresión-múltiple.html#cb140-10" tabindex="-1"></a>    <span class="fl">19.00</span>, <span class="fl">24.00</span>, <span class="fl">2.50</span>, <span class="fl">7.50</span>, <span class="fl">11.00</span>,</span>
<span id="cb140-11"><a href="regresión-múltiple.html#cb140-11" tabindex="-1"></a>    <span class="fl">13.00</span>, <span class="fl">3.75</span>, <span class="fl">25.00</span>, <span class="fl">9.75</span>, <span class="fl">22.00</span>,</span>
<span id="cb140-12"><a href="regresión-múltiple.html#cb140-12" tabindex="-1"></a>    <span class="fl">18.00</span>, <span class="fl">6.00</span>, <span class="fl">12.50</span>, <span class="fl">2.00</span>, <span class="fl">21.50</span></span>
<span id="cb140-13"><a href="regresión-múltiple.html#cb140-13" tabindex="-1"></a>  )</span>
<span id="cb140-14"><a href="regresión-múltiple.html#cb140-14" tabindex="-1"></a>)</span>
<span id="cb140-15"><a href="regresión-múltiple.html#cb140-15" tabindex="-1"></a></span>
<span id="cb140-16"><a href="regresión-múltiple.html#cb140-16" tabindex="-1"></a>datos</span></code></pre></div>
<pre><code>##    Fuerza_enlace Edad_lote
## 1        2158.70     15.50
## 2        1678.15     23.75
## 3        2316.00      8.00
## 4        2061.30     17.00
## 5        2207.50      5.50
## 6        1708.30     19.00
## 7        1784.70     24.00
## 8        2575.00      2.50
## 9        2357.90      7.50
## 10       2256.70     11.00
## 11       2165.20     13.00
## 12       2399.55      3.75
## 13       1779.80     25.00
## 14       2336.75      9.75
## 15       1765.30     22.00
## 16       2053.50     18.00
## 17       2414.40      6.00
## 18       2200.50     12.50
## 19       2654.20      2.00
## 20       1753.70     21.50</code></pre>
<p>Un modelo completo sería <span class="math inline">\(y_i = \beta_0 + \beta_1x_i + \epsilon_i\)</span>, el cual se ve como:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="regresión-múltiple.html#cb142-1" tabindex="-1"></a>modelo_completo <span class="ot">&lt;-</span> <span class="fu">lm</span>(Fuerza_enlace <span class="sc">~</span> Edad_lote, <span class="at">data =</span> datos)</span>
<span id="cb142-2"><a href="regresión-múltiple.html#cb142-2" tabindex="-1"></a></span>
<span id="cb142-3"><a href="regresión-múltiple.html#cb142-3" tabindex="-1"></a><span class="fu">plot</span>(datos<span class="sc">$</span>Edad_lote, datos<span class="sc">$</span>Fuerza_enlace,</span>
<span id="cb142-4"><a href="regresión-múltiple.html#cb142-4" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Modelo completo&quot;</span>,</span>
<span id="cb142-5"><a href="regresión-múltiple.html#cb142-5" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Edad del lote (semanas)&quot;</span>,</span>
<span id="cb142-6"><a href="regresión-múltiple.html#cb142-6" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Fuerza del enlace (psi)&quot;</span>,</span>
<span id="cb142-7"><a href="regresión-múltiple.html#cb142-7" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb142-8"><a href="regresión-múltiple.html#cb142-8" tabindex="-1"></a></span>
<span id="cb142-9"><a href="regresión-múltiple.html#cb142-9" tabindex="-1"></a><span class="co"># Agregar la recta de regresión</span></span>
<span id="cb142-10"><a href="regresión-múltiple.html#cb142-10" tabindex="-1"></a><span class="fu">abline</span>(modelo_completo, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="MultivariateStatisticalAnalysis_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="regresión-múltiple.html#cb143-1" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(<span class="at">x =</span> Edad_lote, <span class="at">y =</span> Fuerza_enlace)) <span class="sc">+</span></span>
<span id="cb143-2"><a href="regresión-múltiple.html#cb143-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb143-3"><a href="regresión-múltiple.html#cb143-3" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb143-4"><a href="regresión-múltiple.html#cb143-4" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb143-5"><a href="regresión-múltiple.html#cb143-5" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Modelo completo&quot;</span>,</span>
<span id="cb143-6"><a href="regresión-múltiple.html#cb143-6" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Edad del lote (semanas)&quot;</span>,</span>
<span id="cb143-7"><a href="regresión-múltiple.html#cb143-7" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Fuerza del enlace (psi)&quot;</span></span>
<span id="cb143-8"><a href="regresión-múltiple.html#cb143-8" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb143-9"><a href="regresión-múltiple.html#cb143-9" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="MultivariateStatisticalAnalysis_files/figure-html/unnamed-chunk-60-1.png" width="672" />
Queremos ver si un modelo reducido explica mejor o no a los datos. En este caso el modelo con menos parámetros o modelo reducido es el modelo que describirá la hipótesis nula <span class="math inline">\(H_0\)</span>. En regresión lineal simple, es común plantear <span class="math inline">\(H_0:\beta_1=0\)</span>, de manera que el modelo reducido es <span class="math inline">\(y_i=\beta_0+\epsilon_i\)</span>, es decir, cada valor <span class="math inline">\(y_i\)</span> es función de una constante (la media) y un error, este modelo se vería como:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="regresión-múltiple.html#cb145-1" tabindex="-1"></a>modelo_reducido <span class="ot">&lt;-</span> <span class="fu">lm</span>(Fuerza_enlace <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> datos)</span>
<span id="cb145-2"><a href="regresión-múltiple.html#cb145-2" tabindex="-1"></a></span>
<span id="cb145-3"><a href="regresión-múltiple.html#cb145-3" tabindex="-1"></a><span class="fu">plot</span>(datos<span class="sc">$</span>Edad_lote, datos<span class="sc">$</span>Fuerza_enlace,</span>
<span id="cb145-4"><a href="regresión-múltiple.html#cb145-4" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Modelo reducido&quot;</span>,</span>
<span id="cb145-5"><a href="regresión-múltiple.html#cb145-5" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Edad del lote (semanas)&quot;</span>,</span>
<span id="cb145-6"><a href="regresión-múltiple.html#cb145-6" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Fuerza del enlace (psi)&quot;</span>,</span>
<span id="cb145-7"><a href="regresión-múltiple.html#cb145-7" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb145-8"><a href="regresión-múltiple.html#cb145-8" tabindex="-1"></a></span>
<span id="cb145-9"><a href="regresión-múltiple.html#cb145-9" tabindex="-1"></a><span class="co"># Agregar la recta de regresión</span></span>
<span id="cb145-10"><a href="regresión-múltiple.html#cb145-10" tabindex="-1"></a><span class="fu">abline</span>(modelo_reducido, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="MultivariateStatisticalAnalysis_files/figure-html/unnamed-chunk-61-1.png" width="672" /></p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="regresión-múltiple.html#cb146-1" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(<span class="at">x =</span> Edad_lote, <span class="at">y =</span> Fuerza_enlace)) <span class="sc">+</span></span>
<span id="cb146-2"><a href="regresión-múltiple.html#cb146-2" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb146-3"><a href="regresión-múltiple.html#cb146-3" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">formula =</span> y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">fullrange =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb146-4"><a href="regresión-múltiple.html#cb146-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Modelo reducido&quot;</span>,</span>
<span id="cb146-5"><a href="regresión-múltiple.html#cb146-5" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Edad del lote (semanas)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Fuerza del enlace (psi)&quot;</span>) <span class="sc">+</span></span>
<span id="cb146-6"><a href="regresión-múltiple.html#cb146-6" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="MultivariateStatisticalAnalysis_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
<p>¿Cuál modelo es mejor? Debemos obtener los estimadores para cada modelo y la suma de cuadrados de los errores.</p>
<ul>
<li><p>La suma de los cuadrados de los errores <span class="math inline">\(SSE(C) = \sum(y_i - \hat{y}_i)^2\)</span>, la cual tiene <span class="math inline">\(n-2\)</span> grados de libertad para el modelo completo.</p></li>
<li><p>La suma de los cuadrados de los errores del modelo reducido <span class="math inline">\(SSE(R) = \sum(y_i - \bar{y}_i)^2\)</span>, la cual tiene <span class="math inline">\(n-1\)</span> grados de libertad para el modelo reducido.</p></li>
</ul>
<p>Hay que tener en cuenta que <span class="math inline">\(SSE(R)\)</span> siempre es mayor a <span class="math inline">\(SSE(C)\)</span>, por lo tanto si la diferencia es miu pequeña, entonces tiene sentido utilizar el modelo reducido, pero si la diferencia es muy grande, entonces el parámetro adicional agrega información importante al modelo.</p>
<p>Se usa la prueba <span class="math inline">\(F\)</span> general:</p>
<p><span class="math display">\[F_0 = \frac{\left( \frac{SSE(R) - SSE(C)}{ (n-1) - (n-2)}  \right)}{\frac{SSE(C)}{n-2}} = \frac{SCE(C)}{\frac{SSE(C)}{n-2}}   \]</span></p>
<p>La cantidad <span class="math inline">\(SSE(R) - SSE(C)\)</span> representa la suma de cuadrados explicada por la variable <span class="math inline">\(x\)</span>, a esta cantidad la vamos a denotar por <span class="math inline">\(SCE\)</span>.</p>
<p>Entonces, rechazar la hipótesis nula <span class="math inline">\(H_0\)</span> implica rechazar el modelo reducido y no rechazar <span class="math inline">\(H_0\)</span> implica rechazar el modelo completo.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="regresión-múltiple.html#cb147-1" tabindex="-1"></a><span class="fu">anova</span>(modelo_completo)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Fuerza_enlace
##           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
## Edad_lote  1 1527483 1527483  165.38 1.643e-10 ***
## Residuals 18  166255    9236                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Como el p-valor es muy pequeño, se rechaza <span class="math inline">\(H_0\)</span> por lo que se concluye que hay pruebas suficientes sobre la existencia de asociación lineal de la edad de lote y la fuerza del enlace.</p>
<p>Todo esto, se puede llevar al caso de regresión lineal múltiple.</p>
<p><strong>Ejemplo:</strong> Considere los siguientes datos en los que se tienen mediciones del tamaño de infarto, área de la región en riesgo y dos variables que identifican el tipo de tratamiento utilizado en 32 pacientes. Se busca describir el tamaño del infarto a través de las otras 3-variables. Para este caso, vamos a ajustar un modelo de regresión lineal múltiple completo y después vamos a hacer pruebas sobre quitar algunas variables.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="regresión-múltiple.html#cb149-1" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb149-2"><a href="regresión-múltiple.html#cb149-2" tabindex="-1"></a>  <span class="at">Paciente =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">32</span>,</span>
<span id="cb149-3"><a href="regresión-múltiple.html#cb149-3" tabindex="-1"></a>  <span class="at">Infarc =</span> <span class="fu">c</span>(</span>
<span id="cb149-4"><a href="regresión-múltiple.html#cb149-4" tabindex="-1"></a>    <span class="fl">0.119</span>, <span class="fl">0.190</span>, <span class="fl">0.395</span>, <span class="fl">0.469</span>, <span class="fl">0.130</span>, <span class="fl">0.311</span>, <span class="fl">0.418</span>, <span class="fl">0.480</span>,</span>
<span id="cb149-5"><a href="regresión-múltiple.html#cb149-5" tabindex="-1"></a>    <span class="fl">0.687</span>, <span class="fl">0.847</span>, <span class="fl">0.062</span>, <span class="fl">0.122</span>, <span class="fl">0.033</span>, <span class="fl">0.102</span>, <span class="fl">0.206</span>, <span class="fl">0.249</span>,</span>
<span id="cb149-6"><a href="regresión-múltiple.html#cb149-6" tabindex="-1"></a>    <span class="fl">0.220</span>, <span class="fl">0.299</span>, <span class="fl">0.350</span>, <span class="fl">0.350</span>, <span class="fl">0.588</span>, <span class="fl">0.379</span>, <span class="fl">0.149</span>, <span class="fl">0.316</span>,</span>
<span id="cb149-7"><a href="regresión-múltiple.html#cb149-7" tabindex="-1"></a>    <span class="fl">0.390</span>, <span class="fl">0.429</span>, <span class="fl">0.477</span>, <span class="fl">0.439</span>, <span class="fl">0.446</span>, <span class="fl">0.538</span>, <span class="fl">0.625</span>, <span class="fl">0.974</span></span>
<span id="cb149-8"><a href="regresión-múltiple.html#cb149-8" tabindex="-1"></a>  ),</span>
<span id="cb149-9"><a href="regresión-múltiple.html#cb149-9" tabindex="-1"></a>  <span class="at">Area =</span> <span class="fu">c</span>(</span>
<span id="cb149-10"><a href="regresión-múltiple.html#cb149-10" tabindex="-1"></a>    <span class="fl">0.34</span>, <span class="fl">0.64</span>, <span class="fl">0.76</span>, <span class="fl">0.83</span>, <span class="fl">0.73</span>, <span class="fl">0.82</span>, <span class="fl">0.95</span>, <span class="fl">1.06</span>,</span>
<span id="cb149-11"><a href="regresión-múltiple.html#cb149-11" tabindex="-1"></a>    <span class="fl">1.20</span>, <span class="fl">1.47</span>, <span class="fl">0.44</span>, <span class="fl">0.77</span>, <span class="fl">0.90</span>, <span class="fl">1.07</span>, <span class="fl">1.01</span>, <span class="fl">1.03</span>,</span>
<span id="cb149-12"><a href="regresión-múltiple.html#cb149-12" tabindex="-1"></a>    <span class="fl">1.16</span>, <span class="fl">1.21</span>, <span class="fl">1.20</span>, <span class="fl">1.22</span>, <span class="fl">0.99</span>, <span class="fl">0.77</span>, <span class="fl">1.05</span>, <span class="fl">1.06</span>,</span>
<span id="cb149-13"><a href="regresión-múltiple.html#cb149-13" tabindex="-1"></a>    <span class="fl">1.02</span>, <span class="fl">0.99</span>, <span class="fl">0.97</span>, <span class="fl">1.12</span>, <span class="fl">1.23</span>, <span class="fl">1.19</span>, <span class="fl">1.22</span>, <span class="fl">1.40</span></span>
<span id="cb149-14"><a href="regresión-múltiple.html#cb149-14" tabindex="-1"></a>  ),</span>
<span id="cb149-15"><a href="regresión-múltiple.html#cb149-15" tabindex="-1"></a>  <span class="at">X2 =</span> <span class="fu">c</span>(</span>
<span id="cb149-16"><a href="regresión-múltiple.html#cb149-16" tabindex="-1"></a>    <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb149-17"><a href="regresión-múltiple.html#cb149-17" tabindex="-1"></a>    <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,</span>
<span id="cb149-18"><a href="regresión-múltiple.html#cb149-18" tabindex="-1"></a>    <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb149-19"><a href="regresión-múltiple.html#cb149-19" tabindex="-1"></a>    <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span></span>
<span id="cb149-20"><a href="regresión-múltiple.html#cb149-20" tabindex="-1"></a>  ),</span>
<span id="cb149-21"><a href="regresión-múltiple.html#cb149-21" tabindex="-1"></a>  <span class="at">X3 =</span> <span class="fu">c</span>(</span>
<span id="cb149-22"><a href="regresión-múltiple.html#cb149-22" tabindex="-1"></a>    <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb149-23"><a href="regresión-múltiple.html#cb149-23" tabindex="-1"></a>    <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb149-24"><a href="regresión-múltiple.html#cb149-24" tabindex="-1"></a>    <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,</span>
<span id="cb149-25"><a href="regresión-múltiple.html#cb149-25" tabindex="-1"></a>    <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span></span>
<span id="cb149-26"><a href="regresión-múltiple.html#cb149-26" tabindex="-1"></a>  )</span>
<span id="cb149-27"><a href="regresión-múltiple.html#cb149-27" tabindex="-1"></a>)</span>
<span id="cb149-28"><a href="regresión-múltiple.html#cb149-28" tabindex="-1"></a>datos</span></code></pre></div>
<pre><code>##    Paciente Infarc Area X2 X3
## 1         1  0.119 0.34  0  0
## 2         2  0.190 0.64  0  0
## 3         3  0.395 0.76  0  0
## 4         4  0.469 0.83  0  0
## 5         5  0.130 0.73  0  0
## 6         6  0.311 0.82  0  0
## 7         7  0.418 0.95  0  0
## 8         8  0.480 1.06  0  0
## 9         9  0.687 1.20  0  0
## 10       10  0.847 1.47  0  0
## 11       11  0.062 0.44  1  0
## 12       12  0.122 0.77  1  0
## 13       13  0.033 0.90  1  0
## 14       14  0.102 1.07  1  0
## 15       15  0.206 1.01  1  0
## 16       16  0.249 1.03  1  0
## 17       17  0.220 1.16  1  0
## 18       18  0.299 1.21  1  0
## 19       19  0.350 1.20  1  0
## 20       20  0.350 1.22  1  0
## 21       21  0.588 0.99  1  0
## 22       22  0.379 0.77  0  0
## 23       23  0.149 1.05  0  1
## 24       24  0.316 1.06  0  1
## 25       25  0.390 1.02  0  1
## 26       26  0.429 0.99  0  1
## 27       27  0.477 0.97  0  1
## 28       28  0.439 1.12  0  1
## 29       29  0.446 1.23  0  1
## 30       30  0.538 1.19  0  1
## 31       31  0.625 1.22  0  1
## 32       32  0.974 1.40  0  1</code></pre>
<p>El modelo completo sería <span class="math inline">\(y_i = \beta_0 + \beta_1x_{1i} +\beta_2x_{2i} + \beta_3x_{3i}+\epsilon_i\)</span>.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="regresión-múltiple.html#cb151-1" tabindex="-1"></a>modelo_c <span class="ot">&lt;-</span> <span class="fu">lm</span>(Infarc<span class="sc">~</span> Area <span class="sc">+</span> X2 <span class="sc">+</span> X3, <span class="at">data =</span> datos)</span>
<span id="cb151-2"><a href="regresión-múltiple.html#cb151-2" tabindex="-1"></a><span class="fu">summary</span>(modelo_c)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Infarc ~ Area + X2 + X3, data = datos)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.28175 -0.06704 -0.01658  0.06294  0.35970 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.14927    0.10377  -1.439 0.161376    
## Area         0.63395    0.10927   5.802 3.12e-06 ***
## X2          -0.25005    0.06053  -4.131 0.000295 ***
## X3          -0.08563    0.06641  -1.289 0.207831    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.138 on 28 degrees of freedom
## Multiple R-squared:  0.6456, Adjusted R-squared:  0.6076 
## F-statistic:    17 on 3 and 28 DF,  p-value: 1.748e-06</code></pre>
<p>Con este modelo se obtiene la siguiente tabla de ANOVA.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="regresión-múltiple.html#cb153-1" tabindex="-1"></a>anov <span class="ot">&lt;-</span> <span class="fu">anova</span>(modelo_c)</span>
<span id="cb153-2"><a href="regresión-múltiple.html#cb153-2" tabindex="-1"></a>anov</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Infarc
##           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
## Area       1 0.62492 0.62492 32.8245 3.801e-06 ***
## X2         1 0.31453 0.31453 16.5210 0.0003533 ***
## X3         1 0.03165 0.03165  1.6624 0.2078307    
## Residuals 28 0.53307 0.01904                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="regresión-múltiple.html#cb155-1" tabindex="-1"></a><span class="do">## los p-valores en la última columna se pueden obtener con: </span></span>
<span id="cb155-2"><a href="regresión-múltiple.html#cb155-2" tabindex="-1"></a><span class="co">#pf(F_0, df1, df2, lower.tail = FALSE)</span></span></code></pre></div>
<p><strong>1) Pruebas sobre uno de los parámetros:</strong> <span class="math inline">\(H_0:\beta_1=0\)</span>, modelo reducido <span class="math inline">\(y_i = \beta_0  +\beta_2x_{2i} + \beta_3x_{3i}+\epsilon_i\)</span>. Vamos a denotar a la suma de los cuadrados de los errores asociada a este modelo <span class="math inline">\(SSE(x_1)\)</span>, la cual tiene <span class="math inline">\(n-3\)</span> grados de libertad asociados (tenemos 3 parámetros a estimar <span class="math inline">\(\beta_0,\beta_2,\beta_3\)</span>). Como el p-valor es muy pequeño, se rechaza a <span class="math inline">\(H_0\)</span> y se concluye que hay suficiente evidencia para decir que el tamaño del infarto está significativamente relacionado con el tamaño del área de riesgo.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="regresión-múltiple.html#cb156-1" tabindex="-1"></a>SCE_X1 <span class="ot">&lt;-</span> anov<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>[<span class="dv">1</span>]</span>
<span id="cb156-2"><a href="regresión-múltiple.html#cb156-2" tabindex="-1"></a>SSE_C <span class="ot">&lt;-</span> anov<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>[<span class="dv">4</span>]</span>
<span id="cb156-3"><a href="regresión-múltiple.html#cb156-3" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> anov<span class="sc">$</span>Df[<span class="dv">4</span>]</span>
<span id="cb156-4"><a href="regresión-múltiple.html#cb156-4" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">nrow</span>(datos) <span class="sc">-</span> <span class="dv">3</span> <span class="sc">-</span> df2</span>
<span id="cb156-5"><a href="regresión-múltiple.html#cb156-5" tabindex="-1"></a>F_g <span class="ot">&lt;-</span> (SCE_X1<span class="sc">/</span>df1) <span class="sc">/</span> (SSE_C<span class="sc">/</span>df2) </span>
<span id="cb156-6"><a href="regresión-múltiple.html#cb156-6" tabindex="-1"></a>F_g</span></code></pre></div>
<pre><code>## [1] 32.82447</code></pre>
<p><strong>2) Pruebas sobre todos los parámetros:</strong> En este caso tenemos <span class="math inline">\(H_0:\beta_1=\beta_2=\beta_3=0\)</span> vs <span class="math inline">\(H_1: \beta_j\neq 0\)</span> p.a. <span class="math inline">\(j\)</span>. Es decir, el modelo reducido sería <span class="math inline">\(y_i = \beta_0+\epsilon_i\)</span>. La prueba <span class="math inline">\(F\)</span> general es la misma, pero ahora la suma de cuadrados asociada al modelo reducido <span class="math inline">\(SSE(x_1,x_2,x_3)\)</span> tiene <span class="math inline">\(n-1\)</span> grados de libertad ya que solo debemos estimar <span class="math inline">\(\beta_0\)</span>.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="regresión-múltiple.html#cb158-1" tabindex="-1"></a>SCE_X1X2X3 <span class="ot">&lt;-</span> <span class="fu">sum</span>(anov<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]) </span>
<span id="cb158-2"><a href="regresión-múltiple.html#cb158-2" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">nrow</span>(datos) <span class="sc">-</span><span class="dv">1</span> <span class="sc">-</span> df2 </span>
<span id="cb158-3"><a href="regresión-múltiple.html#cb158-3" tabindex="-1"></a></span>
<span id="cb158-4"><a href="regresión-múltiple.html#cb158-4" tabindex="-1"></a>F_all <span class="ot">&lt;-</span> (SCE_X1X2X3 <span class="sc">/</span> df1) <span class="sc">/</span> (SSE_C <span class="sc">/</span> df2)</span>
<span id="cb158-5"><a href="regresión-múltiple.html#cb158-5" tabindex="-1"></a>F_all</span></code></pre></div>
<pre><code>## [1] 17.00263</code></pre>
<p>El cual tiene un <span class="math inline">\(p-\)</span>valor asociado a una distribución <span class="math inline">\(F\)</span> con 3 y 28 grados de libertad.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="regresión-múltiple.html#cb160-1" tabindex="-1"></a><span class="fu">pf</span>(F_all, <span class="at">df1 =</span> <span class="dv">3</span>, <span class="at">df2 =</span> <span class="dv">28</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 1.747583e-06</code></pre>
<p>Por lo tanto rechazamos la hipótesis nula. Notemos que este valor coincide con el que nos da el <code>summary</code> del modelo.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="regresión-múltiple.html#cb162-1" tabindex="-1"></a><span class="fu">summary</span>(modelo_c)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Infarc ~ Area + X2 + X3, data = datos)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.28175 -0.06704 -0.01658  0.06294  0.35970 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -0.14927    0.10377  -1.439 0.161376    
## Area         0.63395    0.10927   5.802 3.12e-06 ***
## X2          -0.25005    0.06053  -4.131 0.000295 ***
## X3          -0.08563    0.06641  -1.289 0.207831    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.138 on 28 degrees of freedom
## Multiple R-squared:  0.6456, Adjusted R-squared:  0.6076 
## F-statistic:    17 on 3 and 28 DF,  p-value: 1.748e-06</code></pre>
<p><strong>3) Pruebas sobre un subconjunto de los parámetros:</strong> Supongamos ahora que <span class="math inline">\(H_0:\beta_2=\beta_3=0\)</span>. Es decir, el modelo reducido sería <span class="math inline">\(y_i = \beta_0+ \beta_1x_{1i}+\epsilon_i\)</span>. La prueba es similar pero solo usamos <span class="math inline">\(x_2\)</span> y <span class="math inline">\(x_3\)</span>.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="regresión-múltiple.html#cb164-1" tabindex="-1"></a>SCE_X2X3 <span class="ot">&lt;-</span> <span class="fu">sum</span>(anov<span class="sc">$</span><span class="st">`</span><span class="at">Sum Sq</span><span class="st">`</span>[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]) </span>
<span id="cb164-2"><a href="regresión-múltiple.html#cb164-2" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">nrow</span>(datos) <span class="sc">-</span> <span class="dv">2</span> <span class="sc">-</span> df2 </span>
<span id="cb164-3"><a href="regresión-múltiple.html#cb164-3" tabindex="-1"></a></span>
<span id="cb164-4"><a href="regresión-múltiple.html#cb164-4" tabindex="-1"></a>F_dos <span class="ot">&lt;-</span> (SCE_X2X3 <span class="sc">/</span> df1) <span class="sc">/</span> (SSE_C <span class="sc">/</span> df2)</span>
<span id="cb164-5"><a href="regresión-múltiple.html#cb164-5" tabindex="-1"></a>F_dos</span></code></pre></div>
<pre><code>## [1] 9.091716</code></pre>
<p>El <span class="math inline">\(p-\)</span>valor asociado a la prueba <span class="math inline">\(F\)</span> con 2 y 28 grados de libertad es:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="regresión-múltiple.html#cb166-1" tabindex="-1"></a><span class="fu">pf</span>(F_dos, <span class="at">df1 =</span> <span class="dv">2</span>, <span class="at">df2 =</span> <span class="dv">28</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.0009065789</code></pre>
<p>Por lo que se rechaza de nuevo la hipótesis nula.</p>
<div id="ejercicios-3" class="section level3 hasAnchor" number="2.8.1">
<h3><span class="header-section-number">2.8.1</span> Ejercicios<a href="regresión-múltiple.html#ejercicios-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Ejercicio 1(R):</strong> Para el datasets <code>datasets::trees</code>, realice las pruebas de hipótesis para determinar si:
1) El modelo solo con la variable <code>Girth</code> es mejor que el modelo completo.
2) El modelo sin <code>Girth</code> y <code>Height</code> es mejor que el completo.
Usar la tabla de ANOVA para calcular el estadístico <span class="math inline">\(F_0\)</span> y encontrar el p-valor asociado usando <code>pf(F_0, df1, df2, lower.tail = FALSE)</code>. Justifique su respuesta y suba su código en R a github.</p>
<p><strong>Ejercicio 2(Python):</strong> Para el dataset de <code>marketing</code>, realice las pruebas de hipótesis utilizando la tabla de ANOVA sobre:
1) Uno de los parámetros, justificar cual.
2) Todos los parámetros.
3)Un subconjunto de parámetros, justificar cual.
Usar la tabla de ANOVA para calcular el estadístico <span class="math inline">\(F_0\)</span> y encontrar el p-valor asociado usando <code>pf(F_0, df1, df2, lower.tail = FALSE)</code>. Justifique su respuesta y suba su código en Python a github.</p>
</div>
</div>
<div id="selección-del-modelo" class="section level2 hasAnchor" number="2.9">
<h2><span class="header-section-number">2.9</span> Selección del modelo<a href="#selecci%C3%B3n-del-modelo" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Suponga que se busca una ecuación de regresión lineal entre la variable respuesta <span class="math inline">\(y\)</span> y las variables predictoras <span class="math inline">\(x_1,...,x_p\)</span>. Suponga que se tiene el conjunto de todas las posibles variables a incluir en el modelo <span class="math inline">\(z_1,...z_k\)</span> que son funciones de las <span class="math inline">\(x\)</span>’s. Se busca entonces un modelo que incluya la mayor cantidad de variables <span class="math inline">\(z\)</span> posible para que el error sea pequeño. Pero, considerando la varianza y el costo de obtener más datos, también se busca incluir el menor número de posibles variables <span class="math inline">\(z\)</span> en el modelo.</p>
<p>No existe un solo método de selección de modelos y no todos conducen a la misma solución. Vamos a analizar tres métodos:</p>
<ol style="list-style-type: decimal">
<li>Todos los modelos posibles y el mejor subconjunto de modelos.</li>
<li>Selección paso a paso.</li>
<li>Eliminación hacia atrás.</li>
</ol>
<div id="todos-los-modelos-posibles" class="section level3 hasAnchor" number="2.9.1">
<h3><span class="header-section-number">2.9.1</span> Todos los modelos posibles<a href="regresión-múltiple.html#todos-los-modelos-posibles" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Si el número de variables <span class="math inline">\(z\)</span> es grande, esto puede ser un problema. Supongamos que tenemos <span class="math inline">\(k\)</span> variables, donde cada variable puede o no estar en el modelo, entonces tenemos un total de <span class="math inline">\(2^k\)</span> posibles modelos de los cuales se debe elegir el mejor a partir de criterios como <span class="math inline">\(R^2\)</span>, <span class="math inline">\(R^2_{adj}\)</span>, etc. Vamos a ver algunos de estos criterios.</p>
<p><strong>Estadística <span class="math inline">\(C_p\)</span> de Mallows</strong></p>
<p>Supongamos que tenemos <span class="math inline">\(k+1\)</span> variables regresoras incluyendo el intercepto, de las cuales vamos a elegir <span class="math inline">\(p\)</span>. Denotemos por <span class="math inline">\(SSE_p\)</span> la suma de cuadrados de la regresión respectiva de tomar <span class="math inline">\(p\)</span> variables, la estadística <span class="math inline">\(C_p\)</span> de Mallows está dada por</p>
<p><span class="math display">\[C_p = \frac{SSE_p}{\hat{\sigma}^2} - (n-2p)  \]</span>
donde <span class="math inline">\(\hat{\sigma}^2\)</span> corresponde al modelo con todas las variables y se supone que es un estimador insesgado para la varianza <span class="math inline">\(\sigma^2\)</span>. Si el modelo ajusta bien, esperaríamos que <span class="math inline">\(\mathbb{E}(SSE_p)=(n-p)\sigma^2\)</span>, de manera que:</p>
<p><span class="math display">\[\mathbb{E}(C_p)\approx p,\]</span></p>
<p>en consecuencia, si graficamos <span class="math inline">\(C_p\)</span> en función de <span class="math inline">\(p\)</span>, los modelos adecuados arrojarán puntos cerca de la recta <span class="math inline">\(C_p=p\)</span>.</p>
<p><strong>Criterio de información de Akaike (CIA)</strong></p>
<p>Se define como</p>
<p><span class="math display">\[CIA = e^{\frac{2p}{n}}\frac{SSE}{n},\]</span></p>
<p>donde <span class="math inline">\(p\)</span> es el número de variables regresoras incluyendo el intercepto. Esta función incluye una penalización por imponer regresoras. Al comparar modelos, se busca el que tenga menor <span class="math inline">\(CIA\)</span>. Muchas veces esta estadística se define como <span class="math inline">\(\log(CIA)\)</span>, es decir:</p>
<p><span class="math display">\[\frac{2p}{n}+\log(\frac{SSE}{n})\]</span></p>
<p>con el cual las conclusiones son las mismas.</p>
<p><strong>Criterio de información de Schwars (CIS)</strong></p>
<p>Similar al CIA, el CIS se define como</p>
<p><span class="math display">\[CIS = n^{\frac{p}{n}}\frac{SSE}{n},\]</span></p>
<p>cuyo logaritmo es</p>
<p><span class="math display">\[\frac{p}{n}\log{n} + \log{\frac{SSE}{n}}.\]</span></p>
<p>Este criterio impone mayor penalización por agregar variables. Al comparar modelos, se busca el que tenga menor CIS.</p>
<div id="mejor-subconjunto" class="section level4 hasAnchor" number="2.9.1.1">
<h4><span class="header-section-number">2.9.1.1</span> Mejor subconjunto<a href="regresión-múltiple.html#mejor-subconjunto" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Una alternativa a la comparación de todos los modelos posibles es la búsqueda del mejor subconjunto de modelos que se pueden hacer en distintos programas y compararlos. En R, existe la función <code>regsubsets</code>, la cual incluye los criterios de comparación <span class="math inline">\(R^2, C_p,\)</span> BIC (Bayesian Information Criterion). Esta función utiliza los métodos <em>forward and backward stepwise</em>.</p>
</div>
</div>
<div id="selección-paso-a-paso" class="section level3 hasAnchor" number="2.9.2">
<h3><span class="header-section-number">2.9.2</span> Selección paso a paso<a href="#selecci%C3%B3n-paso-a-paso" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Las técnicas de selección paso a paso consisten en elaborar un modelo inicial a partir del cual se agrega o se elimina una variable para comparar hasta encontrar el mejor modelo.</p>
<div id="selección-paso-a-paso-hacia-adelante" class="section level4 hasAnchor" number="2.9.2.1">
<h4><span class="header-section-number">2.9.2.1</span> Selección paso a paso hacia adelante<a href="#selecci%C3%B3n-paso-a-paso-hacia-adelante" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Conocido como <em>forward regression</em>, consiste en comenzar con el modelo en el que la única variable regresora es la que mejor describe el comportamiento de <span class="math inline">\(y\)</span> y a partir de ahí ir agregando variables regresoras una por una.</p>
<p>El orden en el que se agregan puede variar y se pueden usar diferentes estadísticas o criterios para decidir cual agregar. Se calculan las estadísticas del modelo actual al agregar variable y elegir el modelo con la mejor estadística, siempre que sea un mejor modelo.</p>
</div>
<div id="selección-paso-a-paso-hacia-atrás" class="section level4 hasAnchor" number="2.9.2.2">
<h4><span class="header-section-number">2.9.2.2</span> Selección paso a paso hacia atrás<a href="#selecci%C3%B3n-paso-a-paso-hacia-atr%C3%A1s" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Conocido como <em>backward regression</em>, consiste en comenzar con el modelo que incluye todas las variables e ir eliminando una a una de acuerdo a algún criterio.</p>
<p>Ambas técnicas se pueden mezclar, de manera que en cada paso se evalúa la estadística correspondiente al quitar o agregar alguna de las variables y se elige la mejor opción.</p>
</div>
</div>
<div id="ejemplos" class="section level3 hasAnchor" number="2.9.3">
<h3><span class="header-section-number">2.9.3</span> Ejemplos<a href="regresión-múltiple.html#ejemplos" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="todos-los-modelos-posibles-1" class="section level4 hasAnchor" number="2.9.3.1">
<h4><span class="header-section-number">2.9.3.1</span> Todos los modelos posibles<a href="regresión-múltiple.html#todos-los-modelos-posibles-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>En este ejemplo veremos cómo aplicar el método de seleccion de modelos que implica el análisis de todos los modelos posibles. Primero, necesitaremos varios paquetes.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="regresión-múltiple.html#cb168-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb168-2"><a href="regresión-múltiple.html#cb168-2" tabindex="-1"></a><span class="fu">library</span>(olsrr)</span></code></pre></div>
<pre><code>## 
## Adjuntando el paquete: &#39;olsrr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:datasets&#39;:
## 
##     rivers</code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="regresión-múltiple.html#cb171-1" tabindex="-1"></a><span class="fu">library</span>(leaps)</span>
<span id="cb171-2"><a href="regresión-múltiple.html#cb171-2" tabindex="-1"></a><span class="fu">library</span>(GGally)</span></code></pre></div>
<p><strong>Ejemplo 1:</strong> Cargamos los datos de <code>cemento.txt</code> y hacemos un rápido análisis con el diagrama de dispersión:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="regresión-múltiple.html#cb172-1" tabindex="-1"></a>cemento<span class="ot">&lt;-</span><span class="fu">read.table</span>(<span class="st">&quot;D:/Users/hayde/Documents/R_sites/MultivariateStatisticalAnalysis/data/cement.txt&quot;</span>, <span class="at">header =</span> T, <span class="at">skip=</span><span class="dv">5</span>)</span>
<span id="cb172-2"><a href="regresión-múltiple.html#cb172-2" tabindex="-1"></a><span class="fu">ggpairs</span>(cemento)</span></code></pre></div>
<p><img src="MultivariateStatisticalAnalysis_files/figure-html/unnamed-chunk-74-1.png" width="672" /></p>
<p>A continuación ajustamos el modelo con TODAS las variables independientes y calculamos la estadística <span class="math inline">\(C_p\)</span>. Para facilitar la interpretación graficamos la <span class="math inline">\(C_p\)</span> para cada modelo:</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="regresión-múltiple.html#cb173-1" tabindex="-1"></a>modelo.full<span class="ot">&lt;-</span><span class="fu">lm</span>(y<span class="sc">~</span>., cemento, <span class="at">x=</span>T, <span class="at">y=</span>T)</span>
<span id="cb173-2"><a href="regresión-múltiple.html#cb173-2" tabindex="-1"></a><span class="do">## calcula el AIC, CIS, etc sobre todos los subconjuntos posibles</span></span>
<span id="cb173-3"><a href="regresión-múltiple.html#cb173-3" tabindex="-1"></a>outs<span class="ot">&lt;-</span><span class="fu">leaps</span>(modelo.full<span class="sc">$</span>x, cemento<span class="sc">$</span>y, <span class="at">int=</span><span class="cn">FALSE</span>)</span>
<span id="cb173-4"><a href="regresión-múltiple.html#cb173-4" tabindex="-1"></a><span class="fu">plot</span>(outs<span class="sc">$</span>size,outs<span class="sc">$</span>Cp, <span class="at">log=</span><span class="st">&quot;y&quot;</span>,<span class="at">cex=</span><span class="fl">0.3</span>)</span>
<span id="cb173-5"><a href="regresión-múltiple.html#cb173-5" tabindex="-1"></a><span class="fu">lines</span>(outs<span class="sc">$</span>size,outs<span class="sc">$</span>size)</span>
<span id="cb173-6"><a href="regresión-múltiple.html#cb173-6" tabindex="-1"></a><span class="fu">text</span>(outs<span class="sc">$</span>size, outs<span class="sc">$</span>Cp, <span class="at">labels=</span><span class="fu">row</span>(outs<span class="sc">$</span>which), <span class="at">cex=</span><span class="fl">0.5</span>, <span class="at">pos=</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="MultivariateStatisticalAnalysis_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="regresión-múltiple.html#cb174-1" tabindex="-1"></a><span class="co">#Mejor modelo por la regla Cp ≈ p  (p = número de predictores)</span></span>
<span id="cb174-2"><a href="regresión-múltiple.html#cb174-2" tabindex="-1"></a></span>
<span id="cb174-3"><a href="regresión-múltiple.html#cb174-3" tabindex="-1"></a>idx_best_rule <span class="ot">&lt;-</span> <span class="fu">which.min</span>(<span class="fu">abs</span>(outs<span class="sc">$</span>Cp <span class="sc">-</span> outs<span class="sc">$</span>size))</span>
<span id="cb174-4"><a href="regresión-múltiple.html#cb174-4" tabindex="-1"></a></span>
<span id="cb174-5"><a href="regresión-múltiple.html#cb174-5" tabindex="-1"></a><span class="co">#Variables que entran en cada mejor modelo</span></span>
<span id="cb174-6"><a href="regresión-múltiple.html#cb174-6" tabindex="-1"></a>noms_x <span class="ot">&lt;-</span> <span class="fu">colnames</span>(modelo.full<span class="sc">$</span>x)            <span class="co"># nombres de los predictores</span></span>
<span id="cb174-7"><a href="regresión-múltiple.html#cb174-7" tabindex="-1"></a>vars_rule  <span class="ot">&lt;-</span> noms_x[ outs<span class="sc">$</span>which[idx_best_rule, ] ]</span>
<span id="cb174-8"><a href="regresión-múltiple.html#cb174-8" tabindex="-1"></a></span>
<span id="cb174-9"><a href="regresión-múltiple.html#cb174-9" tabindex="-1"></a>vars_rule</span></code></pre></div>
<pre><code>## [1] &quot;(Intercept)&quot; &quot;x1&quot;          &quot;x2&quot;          &quot;x3&quot;          &quot;x4&quot;</code></pre>
<p>Recordemos que nos interesan los modelos en los que <span class="math inline">\(C_p=p\)</span>.</p>
<p><strong>Ejemplo 2:</strong> Vamos a usar la base de datos <code>mtcars</code>. Otra manera de analizar todos los modelos posibles:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="regresión-múltiple.html#cb176-1" tabindex="-1"></a><span class="fu">library</span>(olsrr)</span>
<span id="cb176-2"><a href="regresión-múltiple.html#cb176-2" tabindex="-1"></a>modelo.full.cars<span class="ot">&lt;-</span><span class="fu">lm</span>(mpg<span class="sc">~</span>., mtcars)</span>
<span id="cb176-3"><a href="regresión-múltiple.html#cb176-3" tabindex="-1"></a>ejemplo<span class="ot">&lt;-</span><span class="fu">ols_step_all_possible</span>(modelo.full.cars)</span>
<span id="cb176-4"><a href="regresión-múltiple.html#cb176-4" tabindex="-1"></a><span class="fu">plot</span>(ejemplo)</span></code></pre></div>
<p><img src="MultivariateStatisticalAnalysis_files/figure-html/unnamed-chunk-77-1.png" width="672" /><img src="MultivariateStatisticalAnalysis_files/figure-html/unnamed-chunk-77-2.png" width="672" /></p>
<p>Observe que en los triángulos rojos aparecen los mejores modelos para cada <span class="math inline">\(p\)</span> en función de la estadística correspondiente.</p>
<p><strong>Ejemplo 3:</strong> R tiene una función que nos muestra el mejor modelo para cada número de variables. Vamos a regresar al conjunto de datos <code>cemento</code>.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="regresión-múltiple.html#cb177-1" tabindex="-1"></a>mejor<span class="ot">&lt;-</span><span class="fu">regsubsets</span>(y<span class="sc">~</span>., cemento)</span>
<span id="cb177-2"><a href="regresión-múltiple.html#cb177-2" tabindex="-1"></a><span class="fu">summary</span>(mejor)</span></code></pre></div>
<pre><code>## Subset selection object
## Call: regsubsets.formula(y ~ ., cemento)
## 4 Variables  (and intercept)
##    Forced in Forced out
## x1     FALSE      FALSE
## x2     FALSE      FALSE
## x3     FALSE      FALSE
## x4     FALSE      FALSE
## 1 subsets of each size up to 4
## Selection Algorithm: exhaustive
##          x1  x2  x3  x4 
## 1  ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot;
## 2  ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot;
## 3  ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot;
## 4  ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot;</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="regresión-múltiple.html#cb179-1" tabindex="-1"></a><span class="fu">plot</span>(mejor,<span class="at">scale=</span><span class="st">&quot;Cp&quot;</span>) </span></code></pre></div>
<p><img src="MultivariateStatisticalAnalysis_files/figure-html/unnamed-chunk-78-1.png" width="672" /></p>
<p>La gráfica muestra los cuatro modelos y su <span class="math inline">\(C_p\)</span>, por ejemplo, el modelo que incluye al intercepto, a <span class="math inline">\(x_1\)</span> y a <span class="math inline">\(x_2\)</span> tiene una <span class="math inline">\(C_p\)</span> cercana a 2.7.</p>
</div>
</div>
<div id="selección-paso-a-paso-1" class="section level3 hasAnchor" number="2.9.4">
<h3><span class="header-section-number">2.9.4</span> Selección paso a paso<a href="#selecci%C3%B3n-paso-a-paso-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Ejemplo 1:</strong> Para analizar el método de selección paso a paso usaremos los datos <em>swiss</em> del paquete <em>MASS</em>. Para ello, el primer paso es ajustar el modelo con TODAS las variables independientes</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="regresión-múltiple.html#cb180-1" tabindex="-1"></a><span class="fu">library</span>(MASS)</span></code></pre></div>
<pre><code>## 
## Adjuntando el paquete: &#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:olsrr&#39;:
## 
##     cement</code></pre>
<pre><code>## The following object is masked from &#39;package:patchwork&#39;:
## 
##     area</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     select</code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="regresión-múltiple.html#cb185-1" tabindex="-1"></a>modelo_completo<span class="ot">&lt;-</span><span class="fu">lm</span>(Fertility<span class="sc">~</span>., swiss)</span></code></pre></div>
<p>Podemos usar la función <em>step</em> en las tres direcciones (<em>forward, backward o both</em>)</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="regresión-múltiple.html#cb186-1" tabindex="-1"></a>paso_a_paso<span class="ot">&lt;-</span><span class="fu">stepAIC</span>(modelo_completo, <span class="at">direction=</span><span class="st">&quot;both&quot;</span>, <span class="at">trace=</span>T)</span></code></pre></div>
<pre><code>## Start:  AIC=190.69
## Fertility ~ Agriculture + Examination + Education + Catholic + 
##     Infant.Mortality
## 
##                    Df Sum of Sq    RSS    AIC
## - Examination       1     53.03 2158.1 189.86
## &lt;none&gt;                          2105.0 190.69
## - Agriculture       1    307.72 2412.8 195.10
## - Infant.Mortality  1    408.75 2513.8 197.03
## - Catholic          1    447.71 2552.8 197.75
## - Education         1   1162.56 3267.6 209.36
## 
## Step:  AIC=189.86
## Fertility ~ Agriculture + Education + Catholic + Infant.Mortality
## 
##                    Df Sum of Sq    RSS    AIC
## &lt;none&gt;                          2158.1 189.86
## + Examination       1     53.03 2105.0 190.69
## - Agriculture       1    264.18 2422.2 193.29
## - Infant.Mortality  1    409.81 2567.9 196.03
## - Catholic          1    956.57 3114.6 205.10
## - Education         1   2249.97 4408.0 221.43</code></pre>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="regresión-múltiple.html#cb188-1" tabindex="-1"></a><span class="fu">summary</span>(paso_a_paso)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Fertility ~ Agriculture + Education + Catholic + 
##     Infant.Mortality, data = swiss)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -14.6765  -6.0522   0.7514   3.1664  16.1422 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      62.10131    9.60489   6.466 8.49e-08 ***
## Agriculture      -0.15462    0.06819  -2.267  0.02857 *  
## Education        -0.98026    0.14814  -6.617 5.14e-08 ***
## Catholic          0.12467    0.02889   4.315 9.50e-05 ***
## Infant.Mortality  1.07844    0.38187   2.824  0.00722 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 7.168 on 42 degrees of freedom
## Multiple R-squared:  0.6993, Adjusted R-squared:  0.6707 
## F-statistic: 24.42 on 4 and 42 DF,  p-value: 1.717e-10</code></pre>
<p><strong>Ejemplo 2:</strong> O podemos usar el paquete <em>olsrr</em>. Base de datos <code>surgical</code>.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="regresión-múltiple.html#cb190-1" tabindex="-1"></a>modelo_completo_sur<span class="ot">&lt;-</span><span class="fu">lm</span>(y<span class="sc">~</span>., surgical)</span>
<span id="cb190-2"><a href="regresión-múltiple.html#cb190-2" tabindex="-1"></a><span class="fu">ols_step_forward_aic</span>(modelo_completo_sur, <span class="at">details =</span> T)</span></code></pre></div>
<pre><code>## Forward Selection Method 
## ------------------------
## 
## Candidate Terms: 
## 
## 1. bcs 
## 2. pindex 
## 3. enzyme_test 
## 4. liver_test 
## 5. age 
## 6. gender 
## 7. alc_mod 
## 8. alc_heavy 
## 
## 
## Step     =&gt; 0 
## Model    =&gt; y ~ 1 
## AIC      =&gt; 802.606 
## 
## Initiating stepwise selection... 
## 
##                        Table: Adding New Variables                        
## -------------------------------------------------------------------------
## Predictor      DF      AIC        SBC       SBIC        R2       Adj. R2  
## -------------------------------------------------------------------------
## liver_test      1    771.875    777.842    616.009    0.45454     0.44405 
## enzyme_test     1    782.629    788.596    626.220    0.33435     0.32154 
## pindex          1    794.100    800.067    637.196    0.17680     0.16097 
## alc_heavy       1    794.301    800.268    637.389    0.17373     0.15784 
## bcs             1    797.697    803.664    640.655    0.12010     0.10318 
## alc_mod         1    802.828    808.795    645.601    0.03239     0.01378 
## gender          1    802.956    808.923    645.725    0.03009     0.01143 
## age             1    803.834    809.801    646.572    0.01420    -0.00476 
## -------------------------------------------------------------------------
## 
## Step     =&gt; 1 
## Added    =&gt; liver_test 
## Model    =&gt; y ~ liver_test 
## AIC      =&gt; 771.8753 
## 
##                       Table: Adding New Variables                        
## ------------------------------------------------------------------------
## Predictor      DF      AIC        SBC       SBIC        R2       Adj. R2 
## ------------------------------------------------------------------------
## alc_heavy       1    761.439    769.395    605.506    0.56674    0.54975 
## enzyme_test     1    762.077    770.033    606.090    0.56159    0.54440 
## pindex          1    770.387    778.343    613.737    0.48866    0.46861 
## alc_mod         1    771.141    779.097    614.435    0.48147    0.46113 
## gender          1    773.802    781.758    616.901    0.45528    0.43391 
## age             1    773.831    781.787    616.928    0.45498    0.43361 
## bcs             1    773.867    781.823    616.961    0.45462    0.43323 
## ------------------------------------------------------------------------
## 
## Step     =&gt; 2 
## Added    =&gt; alc_heavy 
## Model    =&gt; y ~ liver_test + alc_heavy 
## AIC      =&gt; 761.4394 
## 
##                       Table: Adding New Variables                        
## ------------------------------------------------------------------------
## Predictor      DF      AIC        SBC       SBIC        R2       Adj. R2 
## ------------------------------------------------------------------------
## enzyme_test     1    750.509    760.454    595.297    0.65900    0.63854 
## pindex          1    756.125    766.070    600.225    0.62163    0.59892 
## bcs             1    763.063    773.008    606.379    0.56975    0.54394 
## age             1    763.110    773.055    606.421    0.56938    0.54354 
## alc_mod         1    763.428    773.373    606.704    0.56683    0.54084 
## gender          1    763.433    773.378    606.709    0.56679    0.54080 
## ------------------------------------------------------------------------
## 
## Step     =&gt; 3 
## Added    =&gt; enzyme_test 
## Model    =&gt; y ~ liver_test + alc_heavy + enzyme_test 
## AIC      =&gt; 750.5089 
## 
##                      Table: Adding New Variables                       
## ----------------------------------------------------------------------
## Predictor    DF      AIC        SBC       SBIC        R2       Adj. R2 
## ----------------------------------------------------------------------
## pindex        1    735.715    747.649    582.943    0.75015    0.72975 
## bcs           1    750.782    762.716    595.377    0.66973    0.64277 
## alc_mod       1    752.403    764.337    596.743    0.65967    0.63189 
## age           1    752.416    764.350    596.755    0.65959    0.63180 
## gender        1    752.509    764.443    596.833    0.65900    0.63116 
## ----------------------------------------------------------------------
## 
## Step     =&gt; 4 
## Added    =&gt; pindex 
## Model    =&gt; y ~ liver_test + alc_heavy + enzyme_test + pindex 
## AIC      =&gt; 735.7146 
## 
##                      Table: Adding New Variables                       
## ----------------------------------------------------------------------
## Predictor    DF      AIC        SBC       SBIC        R2       Adj. R2 
## ----------------------------------------------------------------------
## bcs           1    730.620    744.543    579.638    0.78091    0.75808 
## age           1    737.680    751.603    585.012    0.75030    0.72429 
## gender        1    737.712    751.635    585.036    0.75016    0.72413 
## alc_mod       1    737.713    751.636    585.037    0.75015    0.72413 
## ----------------------------------------------------------------------
## 
## Step     =&gt; 5 
## Added    =&gt; bcs 
## Model    =&gt; y ~ liver_test + alc_heavy + enzyme_test + pindex + bcs 
## AIC      =&gt; 730.6204 
## 
##                      Table: Adding New Variables                       
## ----------------------------------------------------------------------
## Predictor    DF      AIC        SBC       SBIC        R2       Adj. R2 
## ----------------------------------------------------------------------
## age           1    732.494    748.406    581.938    0.78142    0.75351 
## gender        1    732.551    748.463    581.978    0.78119    0.75325 
## alc_mod       1    732.614    748.526    582.023    0.78093    0.75297 
## ----------------------------------------------------------------------
## 
## 
## No more variables to be added.
## 
## Variables Selected: 
## 
## =&gt; liver_test 
## =&gt; alc_heavy 
## =&gt; enzyme_test 
## =&gt; pindex 
## =&gt; bcs</code></pre>
<pre><code>## 
## 
##                               Stepwise Summary                              
## --------------------------------------------------------------------------
## Step    Variable         AIC        SBC       SBIC        R2       Adj. R2 
## --------------------------------------------------------------------------
##  0      Base Model     802.606    806.584    646.794    0.00000    0.00000 
##  1      liver_test     771.875    777.842    616.009    0.45454    0.44405 
##  2      alc_heavy      761.439    769.395    605.506    0.56674    0.54975 
##  3      enzyme_test    750.509    760.454    595.297    0.65900    0.63854 
##  4      pindex         735.715    747.649    582.943    0.75015    0.72975 
##  5      bcs            730.620    744.543    579.638    0.78091    0.75808 
## --------------------------------------------------------------------------
## 
## Final Model Output 
## ------------------
## 
##                            Model Summary                            
## -------------------------------------------------------------------
## R                         0.884       RMSE                 184.276 
## R-Squared                 0.781       MSE                33957.712 
## Adj. R-Squared            0.758       Coef. Var             27.839 
## Pred R-Squared            0.700       AIC                  730.620 
## MAE                     137.656       SBC                  744.543 
## -------------------------------------------------------------------
##  RMSE: Root Mean Square Error 
##  MSE: Mean Square Error 
##  MAE: Mean Absolute Error 
##  AIC: Akaike Information Criteria 
##  SBC: Schwarz Bayesian Criteria 
## 
##                                  ANOVA                                  
## -----------------------------------------------------------------------
##                    Sum of                                              
##                   Squares        DF    Mean Square      F         Sig. 
## -----------------------------------------------------------------------
## Regression    6535804.090         5    1307160.818    34.217    0.0000 
## Residual      1833716.447        48      38202.426                     
## Total         8369520.537        53                                    
## -----------------------------------------------------------------------
## 
##                                       Parameter Estimates                                        
## ------------------------------------------------------------------------------------------------
##       model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
## ------------------------------------------------------------------------------------------------
## (Intercept)    -1178.330       208.682                 -5.647    0.000    -1597.914    -758.746 
##  liver_test       58.064        40.144        0.156     1.446    0.155      -22.652     138.779 
##   alc_heavy      317.848        71.634        0.314     4.437    0.000      173.818     461.878 
## enzyme_test        9.748         1.656        0.521     5.887    0.000        6.419      13.077 
##      pindex        8.924         1.808        0.380     4.935    0.000        5.288      12.559 
##         bcs       59.864        23.060        0.241     2.596    0.012       13.498     106.230 
## ------------------------------------------------------------------------------------------------</code></pre>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="regresión-múltiple.html#cb193-1" tabindex="-1"></a><span class="fu">ols_step_backward_aic</span>(modelo_completo_sur)</span></code></pre></div>
<pre><code>## 
## 
##                              Stepwise Summary                              
## -------------------------------------------------------------------------
## Step    Variable        AIC        SBC       SBIC        R2       Adj. R2 
## -------------------------------------------------------------------------
##  0      Full Model    736.390    756.280    586.665    0.78184    0.74305 
##  1      alc_mod       734.407    752.308    583.884    0.78177    0.74856 
##  2      gender        732.494    748.406    581.290    0.78142    0.75351 
##  3      age           730.620    744.543    578.844    0.78091    0.75808 
## -------------------------------------------------------------------------
## 
## Final Model Output 
## ------------------
## 
##                            Model Summary                            
## -------------------------------------------------------------------
## R                         0.884       RMSE                 184.276 
## R-Squared                 0.781       MSE                33957.712 
## Adj. R-Squared            0.758       Coef. Var             27.839 
## Pred R-Squared            0.700       AIC                  730.620 
## MAE                     137.656       SBC                  744.543 
## -------------------------------------------------------------------
##  RMSE: Root Mean Square Error 
##  MSE: Mean Square Error 
##  MAE: Mean Absolute Error 
##  AIC: Akaike Information Criteria 
##  SBC: Schwarz Bayesian Criteria 
## 
##                                  ANOVA                                  
## -----------------------------------------------------------------------
##                    Sum of                                              
##                   Squares        DF    Mean Square      F         Sig. 
## -----------------------------------------------------------------------
## Regression    6535804.090         5    1307160.818    34.217    0.0000 
## Residual      1833716.447        48      38202.426                     
## Total         8369520.537        53                                    
## -----------------------------------------------------------------------
## 
##                                       Parameter Estimates                                        
## ------------------------------------------------------------------------------------------------
##       model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
## ------------------------------------------------------------------------------------------------
## (Intercept)    -1178.330       208.682                 -5.647    0.000    -1597.914    -758.746 
##         bcs       59.864        23.060        0.241     2.596    0.012       13.498     106.230 
##      pindex        8.924         1.808        0.380     4.935    0.000        5.288      12.559 
## enzyme_test        9.748         1.656        0.521     5.887    0.000        6.419      13.077 
##  liver_test       58.064        40.144        0.156     1.446    0.155      -22.652     138.779 
##   alc_heavy      317.848        71.634        0.314     4.437    0.000      173.818     461.878 
## ------------------------------------------------------------------------------------------------</code></pre>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="regresión-múltiple.html#cb195-1" tabindex="-1"></a><span class="fu">ols_step_forward_aic</span>(modelo_completo_sur)</span></code></pre></div>
<pre><code>## 
## 
##                               Stepwise Summary                              
## --------------------------------------------------------------------------
## Step    Variable         AIC        SBC       SBIC        R2       Adj. R2 
## --------------------------------------------------------------------------
##  0      Base Model     802.606    806.584    646.794    0.00000    0.00000 
##  1      liver_test     771.875    777.842    616.009    0.45454    0.44405 
##  2      alc_heavy      761.439    769.395    605.506    0.56674    0.54975 
##  3      enzyme_test    750.509    760.454    595.297    0.65900    0.63854 
##  4      pindex         735.715    747.649    582.943    0.75015    0.72975 
##  5      bcs            730.620    744.543    579.638    0.78091    0.75808 
## --------------------------------------------------------------------------
## 
## Final Model Output 
## ------------------
## 
##                            Model Summary                            
## -------------------------------------------------------------------
## R                         0.884       RMSE                 184.276 
## R-Squared                 0.781       MSE                33957.712 
## Adj. R-Squared            0.758       Coef. Var             27.839 
## Pred R-Squared            0.700       AIC                  730.620 
## MAE                     137.656       SBC                  744.543 
## -------------------------------------------------------------------
##  RMSE: Root Mean Square Error 
##  MSE: Mean Square Error 
##  MAE: Mean Absolute Error 
##  AIC: Akaike Information Criteria 
##  SBC: Schwarz Bayesian Criteria 
## 
##                                  ANOVA                                  
## -----------------------------------------------------------------------
##                    Sum of                                              
##                   Squares        DF    Mean Square      F         Sig. 
## -----------------------------------------------------------------------
## Regression    6535804.090         5    1307160.818    34.217    0.0000 
## Residual      1833716.447        48      38202.426                     
## Total         8369520.537        53                                    
## -----------------------------------------------------------------------
## 
##                                       Parameter Estimates                                        
## ------------------------------------------------------------------------------------------------
##       model         Beta    Std. Error    Std. Beta      t        Sig         lower       upper 
## ------------------------------------------------------------------------------------------------
## (Intercept)    -1178.330       208.682                 -5.647    0.000    -1597.914    -758.746 
##  liver_test       58.064        40.144        0.156     1.446    0.155      -22.652     138.779 
##   alc_heavy      317.848        71.634        0.314     4.437    0.000      173.818     461.878 
## enzyme_test        9.748         1.656        0.521     5.887    0.000        6.419      13.077 
##      pindex        8.924         1.808        0.380     4.935    0.000        5.288      12.559 
##         bcs       59.864        23.060        0.241     2.596    0.012       13.498     106.230 
## ------------------------------------------------------------------------------------------------</code></pre>
<p>Ojo: el parámetro <em>details=T</em> nos dará en detalle el proceso con el que se llegó al modelo correspondiente. También hay que tener en cuenta que podríamos llegar a modelos diferentes si usamos métodos diferentes.</p>
<p>Si podemos llegar a resultados diferentes, ¿cómo sabemos cuál es el mejor modelo?.</p>
<p>Recordemos que estos métodos se basan en UNA SOLA estadística para ir mejorando el modelo, de manera que, aunque tengamos el modelo con el AIC menor, este podría no ser el mejor en términos del cumplimiento de los supuestos.</p>
<p><strong>Ejemplo 3</strong> Veamos con mas detalle el modelo de <em>cement.txt</em>.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="regresión-múltiple.html#cb197-1" tabindex="-1"></a><span class="co">#Modelo elegido por el algoritmo</span></span>
<span id="cb197-2"><a href="regresión-múltiple.html#cb197-2" tabindex="-1"></a>modelo.bueno<span class="ot">&lt;-</span><span class="fu">lm</span>(y<span class="sc">~</span>.<span class="sc">-</span>x3, cemento)</span>
<span id="cb197-3"><a href="regresión-múltiple.html#cb197-3" tabindex="-1"></a><span class="fu">summary</span>(modelo.bueno)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ . - x3, data = cemento)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.0919 -1.8016  0.2562  1.2818  3.8982 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  71.6483    14.1424   5.066 0.000675 ***
## x1            1.4519     0.1170  12.410 5.78e-07 ***
## x2            0.4161     0.1856   2.242 0.051687 .  
## x4           -0.2365     0.1733  -1.365 0.205395    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.309 on 9 degrees of freedom
## Multiple R-squared:  0.9823, Adjusted R-squared:  0.9764 
## F-statistic: 166.8 on 3 and 9 DF,  p-value: 3.323e-08</code></pre>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="regresión-múltiple.html#cb199-1" tabindex="-1"></a><span class="co">#Modelo sin x3 y x4</span></span>
<span id="cb199-2"><a href="regresión-múltiple.html#cb199-2" tabindex="-1"></a>modelo<span class="fl">.12</span><span class="ot">&lt;-</span><span class="fu">lm</span>(y<span class="sc">~</span>x1<span class="sc">+</span>x2, cemento)</span>
<span id="cb199-3"><a href="regresión-múltiple.html#cb199-3" tabindex="-1"></a><span class="fu">summary</span>(modelo<span class="fl">.12</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x1 + x2, data = cemento)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -2.893 -1.574 -1.302  1.363  4.048 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 52.57735    2.28617   23.00 5.46e-10 ***
## x1           1.46831    0.12130   12.11 2.69e-07 ***
## x2           0.66225    0.04585   14.44 5.03e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.406 on 10 degrees of freedom
## Multiple R-squared:  0.9787, Adjusted R-squared:  0.9744 
## F-statistic: 229.5 on 2 and 10 DF,  p-value: 4.407e-09</code></pre>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="regresión-múltiple.html#cb201-1" tabindex="-1"></a><span class="co">#Modelo sin x3 y x2</span></span>
<span id="cb201-2"><a href="regresión-múltiple.html#cb201-2" tabindex="-1"></a>modelo<span class="fl">.14</span><span class="ot">&lt;-</span><span class="fu">lm</span>(y<span class="sc">~</span>x1<span class="sc">+</span>x4, cemento)</span>
<span id="cb201-3"><a href="regresión-múltiple.html#cb201-3" tabindex="-1"></a><span class="fu">summary</span>(modelo<span class="fl">.14</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x1 + x4, data = cemento)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -5.0234 -1.4737  0.1371  1.7305  3.7701 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 103.09738    2.12398   48.54 3.32e-13 ***
## x1            1.43996    0.13842   10.40 1.11e-06 ***
## x4           -0.61395    0.04864  -12.62 1.81e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.734 on 10 degrees of freedom
## Multiple R-squared:  0.9725, Adjusted R-squared:  0.967 
## F-statistic: 176.6 on 2 and 10 DF,  p-value: 1.581e-08</code></pre>
<p>Observamos que en el modelo que elige el algoritmo, la variable X4 no es significativa, y por el diagrama de disperisón vemos que está correlacionada con X2, por ello decidimos analizar el modelo eliminando X2 y X4. En ambos modelos las variables son significativas y <span class="math inline">\(R^2\)</span> es alta.</p>
<p>Comparemos su AIC</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="regresión-múltiple.html#cb203-1" tabindex="-1"></a><span class="fu">AIC</span>(modelo.bueno, modelo<span class="fl">.12</span>, modelo<span class="fl">.14</span>)</span></code></pre></div>
<pre><code>##              df      AIC
## modelo.bueno  5 63.86629
## modelo.12     4 64.31239
## modelo.14     4 67.63411</code></pre>
<p>Entre los tres, preferimos al <em>modelo.12</em> ya que es el segundo en <em>R^2</em>, todas las variables son significativas y, aunque no tiene el mínimo AIC, sí es muy parecido y es menor que el AIC del <em>modelo.14</em>. Es decir, en conjunto es el <em>modelo.12</em> es el que mejor cumple los supuestos y tiene buenas estadísticas.</p>
<div id="ejercicios-4" class="section level4 hasAnchor" number="2.9.4.1">
<h4><span class="header-section-number">2.9.4.1</span> Ejercicios<a href="regresión-múltiple.html#ejercicios-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><strong>Ejercicio 1:</strong> Para los datos de rendimiento de gasolina. Aplica los tres métodos vistos de selección de modelos. Compara los resultados y especifica cual sería el mejor modelo con cuales estadísticas.</p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="análisis-de-componentes-principales.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/HaydeePeruyero/MultivariateStatisticalAnalysis/edit/main/01-Regresion_multiple.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["MultivariateStatisticalAnalysis.pdf", "MultivariateStatisticalAnalysis.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  },
  "code_folding": "hide"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
